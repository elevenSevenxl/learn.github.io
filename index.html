<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>一纸墨白</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="生活不止眼前的苟且，还有诗和远方">
<meta property="og:type" content="website">
<meta property="og:title" content="一纸墨白">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="一纸墨白">
<meta property="og:description" content="生活不止眼前的苟且，还有诗和远方">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="yxl">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="一纸墨白" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">一纸墨白</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Node" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/04/Node/" class="article-date">
  <time class="dt-published" datetime="2022-06-04T14:46:22.000Z" itemprop="datePublished">2022-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/06/04/Node/">Node</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="1-Node-概述"><a href="#1-Node-概述" class="headerlink" title="1 Node 概述"></a>1 Node 概述</h2><h3 id="1-1-什么是Node-js"><a href="#1-1-什么是Node-js" class="headerlink" title="1.1 什么是Node.js"></a>1.1 什么是Node.js</h3><p>Node.js，也称 Node，是一个基于 <code>Chrome V8</code> 引擎的 JavaScript 运行环境（宿主），与浏览器是等价的。</p>
<p><strong>注意：</strong></p>
<ul>
<li>Node.js 不是一种独立的语言，与 PHP、Python、Perl、Ruby 的”既是语言也是平台” 不同。</li>
<li>Node.js 也不是一个 JavaScript 框架或库，不同于 Vue.js、React.js、Angular、JQuery 等。</li>
<li>运行在 Node.js 上的 JavaScript 不能使用 DOM、BOM，但可以使用 Node.js 提供的各种 API。</li>
</ul>
<h3 id="1-2-什么学习-Node-js"><a href="#1-2-什么学习-Node-js" class="headerlink" title="1. 2 什么学习 Node.js"></a>1. 2 什么学习 Node.js</h3><ul>
<li>学会 Node.js，我们可以使用 JavaScript 进行后端开发，前端工程师秒变全栈工程师。</li>
<li>学会 Node.js，前端可以实现工程化开发，前端自动化工具、模块化打包工具<code>gulp</code>、<code>webpack</code>以及 <code>vue</code>、<code>react</code> 的脚手架工具都是基于 Node 运行的。</li>
<li>学会 Node.js，我们可以开发很多小工具，如自动化脚本，爬虫程序等。</li>
</ul>
<h3 id="1-3-什么是后端开发"><a href="#1-3-什么是后端开发" class="headerlink" title="1.3 什么是后端开发"></a>1.3 什么是后端开发</h3><h4 id="①-前端和后端"><a href="#①-前端和后端" class="headerlink" title="① 前端和后端"></a>① 前端和后端</h4><ul>
<li>前端是运行在客户端上的代码， 也单指WEB前端，运行在客户端浏览器上的代码</li>
<li>后端是运行在服务器端的程序，主要实现业务逻辑，数据库读取等功能</li>
</ul>
<h4 id="②-后端开发的组成"><a href="#②-后端开发的组成" class="headerlink" title="② 后端开发的组成"></a>② 后端开发的组成</h4><ul>
<li>后端编程语言（PHP、Java、C#、GO、Python、Ruby、JavaScript）</li>
<li>WEB服务器程序 （Apache、Tomcat、Nginx、IIS 等）</li>
<li>数据库程序（MySQL、Oricle、SQLite、MongoDB）</li>
</ul>
<h4 id="③-常见后端开发平台"><a href="#③-常见后端开发平台" class="headerlink" title="③ 常见后端开发平台"></a>③ 常见后端开发平台</h4><ul>
<li>LAMP或LNMP （Linux Apache&#x2F;Nginx MySQL PHP ）</li>
<li>JavaEE （Java Tomcat MySQL&#x2F;Oricle）</li>
<li>.NET (C# IIS SQLServer)</li>
<li>Node.js (JavaScript MongoDB&#x2F;MySQL)</li>
</ul>
<h3 id="1-4-Node-js-的特点"><a href="#1-4-Node-js-的特点" class="headerlink" title="1.4 Node.js 的特点"></a>1.4 Node.js 的特点</h3><ul>
<li>单线程</li>
<li>非阻塞 I&#x2F;O (non-blocking I&#x2F;O)</li>
<li>事件驱动 （event-driven）</li>
</ul>
<h2 id="2-安装和使用"><a href="#2-安装和使用" class="headerlink" title="2 安装和使用"></a>2 安装和使用</h2><h3 id="2-1-下载地址"><a href="#2-1-下载地址" class="headerlink" title="2.1 下载地址"></a>2.1 下载地址</h3><p>官方网站 <a target="_blank" rel="noopener" href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></p>
<p>中文网站 <a target="_blank" rel="noopener" href="http://nodejs.cn/download/">http://nodejs.cn/download/</a></p>
<p>历史版本下载 <a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/node/">https://npm.taobao.org/mirrors/node/</a></p>
<h3 id="2-2-版本选择"><a href="#2-2-版本选择" class="headerlink" title="2.2 版本选择"></a>2.2 版本选择</h3><p>注意区分 LTS 版本与 Current 版本的不同，我们推荐安装 LTS 版本。</p>
<p>LTS 为长期稳定版（long term service），对于追求稳定性的企业级项目来说，推荐安装 LTS 版本的 Noode.js。</p>
<p>Current 为新特性尝鲜版，对热衷于尝试新特性的用户来说，可以安装 Current 版本的 Node.js，但是，Current 版本中可能存在隐藏的 Bug 或安全漏洞，因此不推荐在企业级项目中使用 Current 版本的</p>
<h3 id="2-3-REPL-方式运行"><a href="#2-3-REPL-方式运行" class="headerlink" title="2.3 REPL 方式运行"></a>2.3 REPL 方式运行</h3><h5 id="进入REPL"><a href="#进入REPL" class="headerlink" title="进入REPL"></a>进入REPL</h5><p>命令行或终端运行 node ，就进入了 repl 模式</p>
<h5 id="退出REPL"><a href="#退出REPL" class="headerlink" title="退出REPL"></a>退出REPL</h5><p>.exit 或者 按两下 <code>ctrl+c</code> 或者 <code>ctrl+d</code></p>
<h5 id="REPL命令"><a href="#REPL命令" class="headerlink" title="REPL命令"></a>REPL命令</h5><ul>
<li><code>ctrl + c</code> - 按下两次 - 退出 Node REPL。</li>
<li><code>ctrl + d</code> - 退出 Node REPL.</li>
<li>向上&#x2F;向下键 - 查看输入的历史命令*</li>
<li><code>tab</code> 键 - 列出当前变量（对象）</li>
<li><code>.help</code> - 列出使用命令</li>
<li><code>.break</code> - 退出多行表达式</li>
<li><code>.clear</code> - 退出多行表达式</li>
<li><code>.save filename</code> - 保存当前的 Node REPL 会话到指定文件</li>
<li><code>.load filename</code> - 载入当前 Node REPL 会话的文件内容。</li>
</ul>
<h3 id="2-4-脚本方式运行"><a href="#2-4-脚本方式运行" class="headerlink" title="2.4 脚本方式运行"></a>2.4 脚本方式运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node JS脚本文件地址</span><br></pre></td></tr></table></figure>

<h3 id="3-5-命令行工具"><a href="#3-5-命令行工具" class="headerlink" title="3.5 命令行工具"></a>3.5 命令行工具</h3><h4 id="①-windows-平台"><a href="#①-windows-平台" class="headerlink" title="① windows 平台"></a>① windows 平台</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmd</span><br><span class="line">powershell</span><br><span class="line">gitbash</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意：</strong> 可以在资源管理器的地址栏直接输入 cmd 或者 powershell ，可以在该目录下打开命令行工具</p>
</blockquote>
<h4 id="②-macOS-平台"><a href="#②-macOS-平台" class="headerlink" title="② macOS 平台"></a>② macOS 平台</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">终端</span><br></pre></td></tr></table></figure>

<h4 id="③-vscode-内置的终端工具"><a href="#③-vscode-内置的终端工具" class="headerlink" title="③ vscode 内置的终端工具"></a>③ vscode 内置的终端工具</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl + ` 快捷键打开 vscode 内置的终端工具，可以选择 cmd、powershell或者其他已经安装第三方命令行工具</span><br></pre></td></tr></table></figure>



<h2 id="3-内置常量"><a href="#3-内置常量" class="headerlink" title="3 内置常量"></a>3 内置常量</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__dirname		获取JS脚本所在目录的绝对路径</span><br><span class="line">__filename		获取JS脚本自己的绝对路径</span><br></pre></td></tr></table></figure>



<h2 id="4-Buffer"><a href="#4-Buffer" class="headerlink" title="4 Buffer"></a>4 Buffer</h2><h3 id="4-1-Buffer-介绍"><a href="#4-1-Buffer-介绍" class="headerlink" title="4.1 Buffer 介绍"></a>4.1 Buffer 介绍</h3><p>Buffer 是一个和数组类似的对象，不同是 Buffer 是专门用来保存二进制数据的。</p>
<p><strong>特点：</strong></p>
<ul>
<li>大小固定：在创建时就确定了，且无法调整。</li>
<li>性能较好：直接对计算机的内存进行操作。</li>
<li>每个元素大小为 1 字节（byte）。</li>
</ul>
<p><strong>字节单位：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 Byte = 8 bit；</span><br><span class="line">1 KB = 1024 Byte;</span><br><span class="line">1 MB = 1024 KB;</span><br><span class="line">1 GB = 1024 MB;</span><br><span class="line">1 TB = 1024 GB;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="4-2-创建-Buffer"><a href="#4-2-创建-Buffer" class="headerlink" title="4.2 创建 Buffer"></a>4.2 创建 Buffer</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">10</span>);	 <span class="comment">// 创建一个10个长度的 buffer</span></span><br><span class="line"><span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">10</span>, <span class="string">&#x27;a&#x27;</span>);	<span class="comment">// 创建一个10个长度的 buffer, 每个元素填充a（二进制）</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Buffer</span>.<span class="title function_">allocUnsafe</span>(<span class="number">2</span>);		<span class="comment">// 创建一个不安全的 buffer</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">&#x27;abcdject&#x27;</span>);	<span class="comment">// 根据字符串创建buffer，长度由字符串内容决定</span></span><br><span class="line"><span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>])  <span class="comment">// 根据数组创建buffer，长度由数组长度决定</span></span><br></pre></td></tr></table></figure>

<p><strong>alloc 和 allocUnsafe 的区别：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. alloc() 方法，内存开辟空间后，会进行初始化。</span><br><span class="line">2. allocUnsafe() 方法，内存开辟空间后，不进行初始化，可能会保留过去的数据。</span><br></pre></td></tr></table></figure>

<h3 id="4-3-读写-Buffer"><a href="#4-3-读写-Buffer" class="headerlink" title="4.3 读写 Buffer"></a>4.3 读写 Buffer</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单独修改buffer的元素</span></span><br><span class="line">b[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">b[<span class="number">1</span>] = <span class="number">97</span>;</span><br><span class="line">b[<span class="number">2</span>] = <span class="number">65</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取buffer的长度</span></span><br><span class="line">b.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取buffer中的元素</span></span><br><span class="line">b[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历buffer中所有元素</span></span><br><span class="line">b.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item, index);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 buffer 中的内容转为字符串 （默认根据unicode编码）</span></span><br><span class="line">b.<span class="title function_">toString</span>();</span><br></pre></td></tr></table></figure>

<h3 id="4-4-关于溢出"><a href="#4-4-关于溢出" class="headerlink" title="4.4 关于溢出"></a>4.4 关于溢出</h3><p>buffer 每个元素能表示的最大数字是 255，如果超过 255 的数字，会舍去高位（二进制）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> b = <span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">2</span>);</span><br><span class="line">b[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">b[<span class="number">1</span>] = <span class="number">300</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b[<span class="number">0</span>]);	<span class="comment">// 100</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b[<span class="number">1</span>]);  <span class="comment">// 44</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 300 -&gt; 0001 0010 1100  -&gt; 舍去 0001，只保存 0010 1100，等于十进制的 44</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="4-5-关于中文"><a href="#4-5-关于中文" class="headerlink" title="4.5 关于中文"></a>4.5 关于中文</h3><p>一个 UTF-8 的中文字符大多数情况都是占 3 个字节。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0000 ~ 1111</span><br><span class="line">0 ~ 15</span><br><span class="line">0 ~ f</span><br></pre></td></tr></table></figure>

<h2 id="5-内置模块"><a href="#5-内置模块" class="headerlink" title="5 内置模块"></a>5 内置模块</h2><p>Noode 当中的模块分为三种：内置模块，第三方模块以及自定义模块。 不论哪一种模块，在使用时都必须先引入模块。</p>
<h3 id="5-1-模块导入方式"><a href="#5-1-模块导入方式" class="headerlink" title="5.1 模块导入方式"></a>5.1 模块导入方式</h3><p><strong>ComonJS 导入模块的方式：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> 变量 = <span class="built_in">require</span>(<span class="string">&#x27;模块名&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>ES6 导入模块的方式：</strong></p>
<p>要想使用该方式，脚本文件的扩展名不能是 <code>.js</code> 必须是 <code>.mjs</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; 导出的变量名,导出的变量,导出的变量 &#125; <span class="keyword">from</span> <span class="string">&#x27;模块名&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="5-2-path-模块"><a href="#5-2-path-模块" class="headerlink" title="5.2 path 模块"></a>5.2 path 模块</h3><p>path 模块提供了一些用于处理文件路径的小工具，模块的常用方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">path.<span class="title function_">join</span>()		    拼接路径，根据操作系统决定使用 / 还是 \, 第二个参数如果 ../ 开头的会进行处理</span><br><span class="line">path.<span class="title function_">isAbsolute</span>()	判断参数是否是绝对路径</span><br><span class="line">path.<span class="title function_">dirname</span>()		获取路径中的目录名部分</span><br><span class="line">path.<span class="title function_">basename</span>()		获取路径中的文件名部分</span><br><span class="line">path.<span class="title function_">extname</span>()		获取扩展名部分</span><br><span class="line">path.<span class="title function_">resolve</span>()		将相对路径转为绝对路径，可以进行路径拼接（最终结果是绝对路径），推荐</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(path.<span class="title function_">resolve</span>(<span class="string">&#x27;users/cs/images&#x27;</span>));  <span class="comment">//会基于命令行打开的路径进行拼接</span></span><br><span class="line"><span class="comment">// 当前的目录指的是 是命令行打开的目录，不是脚本文件所在的目录</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(path.<span class="title function_">resolve</span>(<span class="string">&#x27;/etc/nginx/nginx.conf&#x27;</span>,<span class="string">&#x27;/assets&#x27;</span>));  <span class="comment">//如果第二个参数是绝对路径，就不会和前面的路径进行拼接  // D:\assets</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">前端中的绝对路径</span><br><span class="line">https://learn.fuming.site/front-end/node/node.html</span><br><span class="line"></span><br><span class="line">后端中使用绝对路径</span><br><span class="line">C:\Windows\System32\cmd.exe     window下的绝对路径</span><br><span class="line">/etc/nginx/nginx.conf           linxu、macos、unix下绝对路径</span><br></pre></td></tr></table></figure>



<h3 id="5-3-url-模块"><a href="#5-3-url-模块" class="headerlink" title="5.3 url 模块"></a>5.3 url 模块</h3><p>url 模块用于 URL 处理与解析。</p>
<p><strong>用法一：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"></span><br><span class="line">cosnt urlObj = url.<span class="title function_">parse</span>(urlStr);  <span class="comment">// urlObj 对象中有很多属性可以获取url的各部分信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Url &#123;</span></span><br><span class="line"><span class="comment">  protocol: &#x27;https:&#x27;,</span></span><br><span class="line"><span class="comment">  slashes: true,</span></span><br><span class="line"><span class="comment">  auth: null,</span></span><br><span class="line"><span class="comment">  host: &#x27;learn.fuming.site:8088&#x27;,</span></span><br><span class="line"><span class="comment">  port: &#x27;8088&#x27;,</span></span><br><span class="line"><span class="comment">  hostname: &#x27;learn.fuming.site&#x27;,</span></span><br><span class="line"><span class="comment">  hash: &#x27;#nav001&#x27;,</span></span><br><span class="line"><span class="comment">  search: &#x27;?name=xiaole&amp;type=2&#x27;,</span></span><br><span class="line"><span class="comment">  query: &#x27;name=xiaole&amp;type=2&#x27;,</span></span><br><span class="line"><span class="comment">  pathname: &#x27;/front-end/node/03node.html&#x27;,</span></span><br><span class="line"><span class="comment">  path: &#x27;/front-end/node/03node.html?name=xiaole&amp;type=2&#x27;,</span></span><br><span class="line"><span class="comment">  href: &#x27;https://learn.fuming.site:8088/front-end/node/03node.html?		   name=xiaole&amp;type=2#nav001&#x27;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>用法二： 推荐</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> urlObj = <span class="keyword">new</span> url.<span class="title function_">URL</span>(urlStr);  <span class="comment">// urlObj 对象中有很多属性可以获取url的各部分信息</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">URL &#123;</span></span><br><span class="line"><span class="comment">  href: &#x27;https://learn.fuming.site:8088/front-end/node/03node.html?name=xiaole&amp;type=2#nav001&#x27;,</span></span><br><span class="line"><span class="comment">  origin: &#x27;https://learn.fuming.site:8088&#x27;,</span></span><br><span class="line"><span class="comment">  protocol: &#x27;https:&#x27;,</span></span><br><span class="line"><span class="comment">  username: &#x27;&#x27;,</span></span><br><span class="line"><span class="comment">  password: &#x27;&#x27;,</span></span><br><span class="line"><span class="comment">  host: &#x27;learn.fuming.site:8088&#x27;,</span></span><br><span class="line"><span class="comment">  hostname: &#x27;learn.fuming.site&#x27;,</span></span><br><span class="line"><span class="comment">  port: &#x27;8088&#x27;,</span></span><br><span class="line"><span class="comment">  pathname: &#x27;/front-end/node/03node.html&#x27;,</span></span><br><span class="line"><span class="comment">  search: &#x27;?name=xiaole&amp;type=2&#x27;,</span></span><br><span class="line"><span class="comment">  searchParams: URLSearchParams &#123; &#x27;name&#x27; =&gt; &#x27;xiaole&#x27;, &#x27;type&#x27; =&gt; &#x27;2&#x27; &#125;,</span></span><br><span class="line"><span class="comment">  hash: &#x27;#nav001&#x27;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">urlObj.<span class="property">searchParams</span>;   <span class="comment">// 该属性可以获取到查询字符串组成的键值对结构的对象 （类似于 Map）</span></span><br><span class="line">urlObj.<span class="property">searchParams</span>.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">urlObj.<span class="property">searchParams</span>.<span class="title function_">get</span>(<span class="string">&#x27;type&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="5-4-querystring-模块"><a href="#5-4-querystring-模块" class="headerlink" title="5.4 querystring 模块"></a>5.4 querystring 模块</h3><p>querystring是一个内置模块。可以将查询字符串（a&#x3D;1&amp;b&#x3D;2）转为对象，也可以将对象转为查询字符串，常用方法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">querystring.parse()			将查询字符串转为对象</span><br><span class="line">querystring.stringify()		将对象转为查询字符串</span><br><span class="line">querystring.decode()		同 parse()</span><br><span class="line">querystring.encode()		同 stringify()	</span><br></pre></td></tr></table></figure>



<h3 id="5-5-os-模块"><a href="#5-5-os-模块" class="headerlink" title="5.5 os 模块"></a>5.5 os 模块</h3><p>该模块提供了与操作系统相关的方法和属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">os.arch()		获取系统架构 x86或者x64等</span><br><span class="line">os.homedir()	获取用户目录</span><br><span class="line">os.userInfo()	获取用户信息</span><br><span class="line">os.freemem()	获取剩余内存量</span><br></pre></td></tr></table></figure>





<h2 id="6-fs-模块"><a href="#6-fs-模块" class="headerlink" title="6  fs 模块"></a>6  fs 模块</h2><p>在 <code>NodeJS</code> 中，所有与文件操作都是通过 <code>fs</code> 核心模块来实现的，包括文件目录的创建、删除、查询以及文件的读取和写入，在 <code>fs</code> 模块中，所有的方法都分为<strong>同步</strong>和<strong>异步</strong>两种实现方式，具有 <code>sync</code> 后缀的方法为同步方法，不具有 <code>sync</code> 后缀的方法为异步方法 。</p>
<h3 id="6-1-文件操作"><a href="#6-1-文件操作" class="headerlink" title="6.1 文件操作"></a>6.1 文件操作</h3><h4 id="①-读取文件"><a href="#①-读取文件" class="headerlink" title="① 读取文件"></a>① 读取文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.readFile()			异步方式读取文件</span><br><span class="line">fs.readFileSync()		同步方法读取文件</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> filepath = path.<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;data.txt&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(filepath);</span><br><span class="line"><span class="comment">// 异步方法</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(filepath,<span class="function">(<span class="params">err,data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;读取失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置编码</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(filepath,<span class="string">&#x27;utf-8&#x27;</span>,<span class="function">(<span class="params">err,data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;读取失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="②-写入文件"><a href="#②-写入文件" class="headerlink" title="② 写入文件"></a>② 写入文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fs.writeFile()			向文件写入内容，文件原本内容会被重置	</span><br><span class="line">fs.writeFileSync()</span><br><span class="line">fs.appendFile()			向文件追加内容，文件原本内容会保留</span><br><span class="line">fs.appendFileSync()</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> filepath = path.<span class="title function_">resolve</span>(__dirname,<span class="string">&#x27;data2.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> content = <span class="string">&#x27;hello world\n&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> content2 = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">&#x27;我是Buffer内容\n&#x27;</span>);</span><br><span class="line"><span class="comment">// fs.writeFile(filepath, content2, err =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if(err)&#123;</span></span><br><span class="line"><span class="comment">//         console.log(&#x27;写入失败！&#x27;);</span></span><br><span class="line"><span class="comment">//         return;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;写入成功&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line">fs.<span class="title function_">writeFile</span>(filepath, content, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;写入失败&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;写入成功&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 追加内容</span></span><br><span class="line">fs.<span class="title function_">appendFile</span>(filepath, content , <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;追加失败！&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;追加成功！&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="③-重命名或移动文件"><a href="#③-重命名或移动文件" class="headerlink" title="③ 重命名或移动文件"></a>③ 重命名或移动文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.rename()				</span><br><span class="line">fs.renameSync()</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">rename</span>(<span class="string">&#x27;./data2副本.txt&#x27;</span>,<span class="string">&#x27;./data2.txt&#x27;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;命名失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;命名成功&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移动文件</span></span><br><span class="line"><span class="comment">// fs.rename(&#x27;../data2副本.txt&#x27;,&#x27;./data2副本.txt&#x27;, err =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if(err)&#123;</span></span><br><span class="line"><span class="comment">//         console.log(&#x27;移动失败&#x27;);</span></span><br><span class="line"><span class="comment">//         return;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;移动成功&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br></pre></td></tr></table></figure>

<h4 id="④-复制文件"><a href="#④-复制文件" class="headerlink" title="④ 复制文件"></a>④ 复制文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.copyFile()</span><br><span class="line">fs.copyFileSync();</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">copyFile</span>(<span class="string">&#x27;./data2.txt&#x27;</span>,<span class="string">&#x27;./data2副本.txt&#x27;</span> , <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;复制失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;复制成功&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="⑤-删除文件"><a href="#⑤-删除文件" class="headerlink" title="⑤ 删除文件"></a>⑤ 删除文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.unlink()</span><br><span class="line">fs.unlinkSync()</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">unlink</span>(<span class="string">&#x27;./data2副本.txt&#x27;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;删除失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;删除成功&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="6-2-目录操作"><a href="#6-2-目录操作" class="headerlink" title="6.2 目录操作"></a>6.2 目录操作</h3><h4 id="①-创建目录"><a href="#①-创建目录" class="headerlink" title="① 创建目录"></a>① 创建目录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.mkdir()</span><br><span class="line">fs.mkdirSync()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果需要创建同时多层目录，需要设置第二个参数  &#123;recursive: true&#125;，表示递归创建</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// fs.mkdir(&#x27;images&#x27;, err =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if(err)&#123;</span></span><br><span class="line"><span class="comment">//         console.log(&#x27;创建失败&#x27;);</span></span><br><span class="line"><span class="comment">//         return;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;创建成功&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// recursive:true 递归创建多级目录</span></span><br><span class="line">fs.<span class="title function_">mkdir</span>(<span class="string">&#x27;./dist/assets/images&#x27;</span>, &#123;<span class="attr">recursive</span>:<span class="literal">true</span>&#125; ,<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;创建失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;创建成功&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="②-删除目录"><a href="#②-删除目录" class="headerlink" title="② 删除目录"></a>② 删除目录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.rmdir()</span><br><span class="line">fs.rmdirSync()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">默认只能删除空目录，如果要删除非空目录，需要设置第二个参数 &#123;recursive: true&#125;，表示递归删除</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除空目录</span></span><br><span class="line"><span class="comment">// fs.rmdir(&#x27;./images&#x27;, err =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if(err)&#123;</span></span><br><span class="line"><span class="comment">//         console.log(&#x27;删除失败&#x27;);</span></span><br><span class="line"><span class="comment">//         return;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;删除成功&#x27;);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除非空目录 设置第二个参数递归删除recursive:true</span></span><br><span class="line">fs.<span class="title function_">rmdir</span>(<span class="string">&#x27;./dist&#x27;</span>, &#123;<span class="attr">recursive</span>:<span class="literal">true</span>&#125; ,<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;删除失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;删除成功&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="③-读取目录"><a href="#③-读取目录" class="headerlink" title="③ 读取目录"></a>③ 读取目录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.readdir()</span><br><span class="line">fs.readdirSync()</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readdir</span>(<span class="string">&#x27;./&#x27;</span>,<span class="function">(<span class="params">err,data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;读取失败&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> v <span class="keyword">of</span> data)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="6-3-文件目录通用操作"><a href="#6-3-文件目录通用操作" class="headerlink" title="6.3 文件目录通用操作"></a>6.3 文件目录通用操作</h3><h4 id="①-判断文件或目录是否存在-可访问性"><a href="#①-判断文件或目录是否存在-可访问性" class="headerlink" title="① 判断文件或目录是否存在(可访问性)"></a>① 判断文件或目录是否存在(可访问性)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fs.exists()			被弃用</span><br><span class="line">fs.existsSync()		返回布尔值</span><br><span class="line">fs.access();		判断文件或目录可访问性， 如果回调函数的错误对象是null，说明文件或目录存在</span><br><span class="line">fs.accessSync();</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// fs.exists(&#x27;../3-fs目录操作/3-读取目录.js&#x27;, result =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     console.log(result); //true</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fs.<span class="title function_">existsSync</span>(<span class="string">&#x27;../3-fs目录操作/2-删除目录.js&#x27;</span>)); <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用access判断文件或目录是否存在</span></span><br><span class="line"><span class="comment">// fs.access(&#x27;../3-fs目录操作/1-创建目录.js&#x27;, err =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     console.log(err);  //null 表示文件存在可以访问</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除之前先判断文件是否存在</span></span><br><span class="line"><span class="keyword">const</span> filepath = path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;data.txt&#x27;</span>);</span><br><span class="line">fs.<span class="title function_">access</span>(filepath,<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;文件不存在删除失败&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        fs.<span class="title function_">unlink</span>(filepath, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(!err)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;删除成功&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="②-获取文件或目录信息，可以用于判断是文件还是目录"><a href="#②-获取文件或目录信息，可以用于判断是文件还是目录" class="headerlink" title="② 获取文件或目录信息，可以用于判断是文件还是目录"></a>② 获取文件或目录信息，可以用于判断是文件还是目录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.stat()</span><br><span class="line">fs.statSync()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">回调函数第二个参数可以获取一个对象，该对象中包含文件的各种信息（尺寸、权限、创建时间等），有方法 isDirectory()、isFile() 可以判断是文件还是目录。</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// stat判断某个路径是文件还是目录</span></span><br><span class="line"><span class="comment">// stat 对象里有size属性代表文件大小</span></span><br><span class="line">fs.<span class="title function_">stat</span>(<span class="string">&#x27;./&#x27;</span>, <span class="function">(<span class="params">err,status</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="comment">// 文件不存在才会报错</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(status.<span class="title function_">isDirectory</span>())&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;该路径是目录&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(status.<span class="title function_">isFile</span>())&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;该路径是文件&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;既不是目录也不是文件&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="③-删除文件或目录"><a href="#③-删除文件或目录" class="headerlink" title="③ 删除文件或目录"></a>③ 删除文件或目录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs.rm();</span><br><span class="line">fs.rmSync();</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除目录的时候默认只能删除空目录，如果要删除非空目录，需要设置第二个参数 &#123;recursive: true&#125;，表示递归删除</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入模块</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除文件</span></span><br><span class="line">fs.<span class="title function_">rm</span>(<span class="string">&#x27;./data.txt&#x27;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;./data.txt 删除失败！&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;./data.txt 删除成功！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除文件</span></span><br><span class="line">fs.<span class="title function_">rm</span>(<span class="string">&#x27;./images&#x27;</span>, &#123;<span class="attr">recursive</span>: <span class="literal">true</span>&#125;,<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;./images 删除失败！&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;./images 删除成功！&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">递归读取目录</span><br><span class="line"><span class="comment">// 导入模块</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 读取目录中的结构</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@params</span> string 目录的路径</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@params</span> string  前面缩进的个数 默认值是 0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">showDir</span> = (<span class="params">filepath, tabNum=<span class="number">0</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 同步读取目录</span></span><br><span class="line">    fs.<span class="title function_">readdirSync</span>(filepath).<span class="title function_">forEach</span>(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;\t&#x27;</span>.<span class="title function_">repeat</span>(tabNum), file);</span><br><span class="line">        <span class="comment">// 拼接子文件的目录</span></span><br><span class="line">        <span class="keyword">const</span> childpath = path.<span class="title function_">resolve</span>(filepath, file);</span><br><span class="line">        <span class="comment">// 如果 childpath 还是一个目录，递归调用</span></span><br><span class="line">        <span class="keyword">const</span> stats = fs.<span class="title function_">statSync</span>(childpath);</span><br><span class="line">        <span class="keyword">if</span> (stats.<span class="title function_">isDirectory</span>()) &#123;</span><br><span class="line">            <span class="comment">// 递归调用</span></span><br><span class="line">            <span class="title function_">showDir</span>(childpath, tabNum+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数</span></span><br><span class="line"><span class="title function_">showDir</span>(<span class="string">&#x27;D:\\Library\\SH220310\\03阶段_工程化\\Day15_Node&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入模块</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 递归函数计算目录的大小</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@params</span> filepath 目录的路径</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> number 计算好的大小，单位:字节</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">dirSize</span> = filepath =&gt; &#123;</span><br><span class="line">    <span class="comment">// 判断 filepath 是目录还是文件</span></span><br><span class="line">    <span class="keyword">const</span> stats = fs.<span class="title function_">statSync</span>(filepath);</span><br><span class="line">    <span class="keyword">if</span> (stats.<span class="title function_">isDirectory</span>()) &#123;</span><br><span class="line">        <span class="comment">// 遍历目录，</span></span><br><span class="line">        <span class="keyword">return</span> fs.<span class="title function_">readdirSync</span>(filepath).<span class="title function_">reduce</span>(<span class="function">(<span class="params">preSize, file</span>) =&gt;</span> preSize + <span class="title function_">dirSize</span>(path.<span class="title function_">resolve</span>(filepath, file)), <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stats.<span class="property">size</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">dirSize</span>(<span class="string">&#x27;D:\\Library\\SH220310\\03阶段_工程化&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">dirSize</span>(<span class="string">&#x27;D:\\Library\\SH220310\\03阶段_工程化\\Day16_Node&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="7-流操作-——-大文件读写"><a href="#7-流操作-——-大文件读写" class="headerlink" title="7  流操作 —— 大文件读写"></a>7  流操作 —— 大文件读写</h2><h4 id="①-读取流"><a href="#①-读取流" class="headerlink" title="① 读取流"></a>① 读取流</h4><ul>
<li><code>fs.createReadStream(path[, options])</code></li>
<li>readStream 对象 <a target="_blank" rel="noopener" href="http://nodejs.cn/api/fs.html#class-fsreadstream">http://nodejs.cn/api/fs.html#class-fsreadstream</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个可读流</span></span><br><span class="line"><span class="keyword">const</span> rs = fs.<span class="title function_">createReadStream</span>(filepath);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取异常</span></span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;读取失败！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 准备就绪事件</span></span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;准备就绪！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 每读取 64KB 的数据就触发一次 data 事件</span></span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function"><span class="params">chunk</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;本次读取：&#x27;</span>, chunk.<span class="property">length</span>, <span class="string">&#x27;已经读取：&#x27;</span>, rs.<span class="property">bytesRead</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取结束</span></span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;读取完毕！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="②-写入流"><a href="#②-写入流" class="headerlink" title="② 写入流"></a>② 写入流</h4><ul>
<li><code>fs.createWriteStream(path[, options])</code></li>
<li>writeStream <a target="_blank" rel="noopener" href="http://nodejs.cn/api/fs.html#class-fswritestream">http://nodejs.cn/api/fs.html#class-fswritestream</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建可写流对象 如果文件不存在会自动创建</span></span><br><span class="line"><span class="keyword">const</span> ws = fs.<span class="title function_">createWriteStream</span>(<span class="string">&#x27;./data.txt&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件打开</span></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;open&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;打开写入文件！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;关闭写入文件&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写入大量的数据</span></span><br><span class="line"><span class="comment">// ws.write(&#x27;hello&#x27;);</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i ++) &#123;</span><br><span class="line">    ws.<span class="title function_">write</span>(<span class="string">&#x27;安妮特别美！\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭</span></span><br><span class="line">ws.<span class="title function_">close</span>();</span><br></pre></td></tr></table></figure>

<h4 id="③-流操作实现大文件复制"><a href="#③-流操作实现大文件复制" class="headerlink" title="③ 流操作实现大文件复制"></a>③ 流操作实现大文件复制</h4><ul>
<li>pipe管道  <a target="_blank" rel="noopener" href="http://nodejs.cn/api/stream.html#stream_readable_pipe_destination_options">http://nodejs.cn/api/stream.html#stream_readable_pipe_destination_options</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建可读流</span></span><br><span class="line"><span class="keyword">const</span> rs = fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;./data.txt&#x27;</span>);</span><br><span class="line"><span class="comment">// 创建可写流</span></span><br><span class="line"><span class="keyword">const</span> ws = fs.<span class="title function_">createWriteStream</span>(<span class="string">&#x27;./data1.txt&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听可读流的 data 事件，每次读取到数据都写入可写流</span></span><br><span class="line"><span class="comment">// rs.on(&#x27;data&#x27;, chunk =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     ws.write(chunk);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"><span class="comment">// // 监听读取完毕</span></span><br><span class="line"><span class="comment">// rs.on(&#x27;end&#x27;, () =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     // 关闭可写流</span></span><br><span class="line"><span class="comment">//     ws.close();</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在可读流和可写流之间建立管道</span></span><br><span class="line">rs.<span class="title function_">pipe</span>(ws);</span><br></pre></td></tr></table></figure>





<h2 id="8-JSON-数据格式以及处理"><a href="#8-JSON-数据格式以及处理" class="headerlink" title="8 JSON 数据格式以及处理"></a>8 JSON 数据格式以及处理</h2><h3 id="8-1-什么是JSON数据格式"><a href="#8-1-什么是JSON数据格式" class="headerlink" title="8.1 什么是JSON数据格式"></a>8.1 什么是<code>JSON</code>数据格式</h3><p><code>JSON</code>全称是 <code>JavaScript Object Notation</code> (JavaScript 对象表示法) ,是一种轻量级的数据交换格式。</p>
<p><code>JSON</code> 的语法与 <code>JS</code> 定义数组和对象的语法存在如下的区别：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. json 中的字符串必须使用双引号</span><br><span class="line">2. json 中的属性名必须使用双引号包裹</span><br><span class="line">3. json 中的最后一个属性不能有逗号</span><br><span class="line">4. json 中的属性值不能是表达式</span><br></pre></td></tr></table></figure>



<h3 id="8-2-JS-中的-JSON-对象"><a href="#8-2-JS-中的-JSON-对象" class="headerlink" title="8.2 JS 中的 JSON 对象"></a>8.2 JS 中的 JSON 对象</h3><ul>
<li><p><code>JSON.stringify(obj/arr)</code>	将对象或数组转为 json 格式的字符串。</p>
</li>
<li><p><code>JSON.parse(json)</code>:&#96;	将 json 格式的字符串转为对象或数组。</p>
</li>
</ul>
<h2 id="9-模块化"><a href="#9-模块化" class="headerlink" title="9 模块化"></a>9 模块化</h2><h3 id="9-1-模块化介绍"><a href="#9-1-模块化介绍" class="headerlink" title="9.1 模块化介绍"></a>9.1 模块化介绍</h3><p>Node 应用由模块（每一个<code>JS</code>即是一个模块）组成，采用<code>CommonJS</code>模块规范(提供了模块引入导出的规则)。每个文件就是一个模块，有自己的作用。<font color=red>在一个文件里面定义的变量、函数、类（class），都是私有的，对其他文件不可见（模块作用域）。在服务器端，模块的加载是运行时同步加载的； </font></p>
<p>模块化是指解决一个复杂问题时，自顶向下逐层把系统划分成若干模块的过程，对于整个系统来说，模块是可组合，分解和更换的单元。</p>
<h3 id="9-2-模块化特点"><a href="#9-2-模块化特点" class="headerlink" title="9.2 模块化特点"></a>9.2 模块化特点</h3><ul>
<li>所有代码都运行在模块作用域，不会污染全局作用域。</li>
<li>模块可以多次加载，但是只会在第一次加载时运行一次，然后运行结果就被缓存了，以后再加载，就直接读取缓存结果。要想让模块再次运行，必须清除缓存。</li>
<li>模块加载的顺序，按照加载模块的代码的书写顺序。</li>
</ul>
<h3 id="9-3-模块化的好处"><a href="#9-3-模块化的好处" class="headerlink" title="9.3 模块化的好处"></a>9.3 模块化的好处</h3><ul>
<li>提高代码的复用性</li>
<li>提高代码的可维护性</li>
<li>可以实现按需加载</li>
</ul>
<h3 id="9-4-模块化规范"><a href="#9-4-模块化规范" class="headerlink" title="9.4 模块化规范"></a>9.4 模块化规范</h3><ul>
<li>模块化规范就是对代码进行模块化的拆分与组合时，需要遵守的那些规则。例如：<ul>
<li>使用什么样的语法格式来引用模块</li>
<li>在模块中使用什么样的语法格式向外暴露数据。</li>
</ul>
</li>
<li>模块化规范的好处：大家都遵守同样的模块化规范写代码，可以有效降低沟通的成本，极大方便了各个模块之间的相互调用，利人利已。</li>
<li>Node 支持 CommonJS 和 ES6 两种模块化规范。</li>
</ul>
<h3 id="9-5-Node-中-模块的分类"><a href="#9-5-Node-中-模块的分类" class="headerlink" title="9.5 Node 中 模块的分类"></a>9.5 Node 中 模块的分类</h3><p>Node.js中根据模块来源的不同，将模块分为了3大类，分别是：</p>
<ul>
<li>内置模块（由Node.js官方提供，例如：fs,path,http）</li>
<li>自定义模块：用户创建的每个JS文件，都是自定义模块。，</li>
<li>第三方模块：由第三方开发出来的模块，并非官方提供的内置模块，也不是用户创建的自定义模块，使用前需要先下载。</li>
</ul>
<h2 id="10-CommonJS-模块规范"><a href="#10-CommonJS-模块规范" class="headerlink" title="10 CommonJS 模块规范"></a>10 CommonJS 模块规范</h2><h3 id="10-1-在模块中暴露数据"><a href="#10-1-在模块中暴露数据" class="headerlink" title="10.1 在模块中暴露数据"></a>10.1 在模块中暴露数据</h3><p>1）模块内如果没有暴露数据，引人模块的时候会得到一个空对象。</p>
<p>2）通过为 <code>module.exports</code> 赋值，实现暴露数据。</p>
<p>3）通过为 <code>module.exports</code> 设置属性，暴露数据。</p>
<p>4）通过为 <code>exports</code> 设置属性，暴露数据。 给 <code>exports</code> 设置属性，就是给 <code>module.exports</code> 设置属性，但不能改变<code>exports</code>的引用地址，这样的话 <code>exports</code> 与 <code>module.exports</code> 就脱钩了。</p>
<h3 id="10-2-引入模块（自定义模块）"><a href="#10-2-引入模块（自定义模块）" class="headerlink" title="10.2 引入模块（自定义模块）"></a>10.2 引入模块（自定义模块）</h3><p>1）自定义模块的地址需要以 <code>./</code>、  <code>../</code>  开头，这是模块文件的相对路径，相对于当前的执行的 JS 脚本的位置，不是命令行打开的目录。</p>
<p>2）如果模块文件的地址没有以  <code>./</code>、  <code>../</code>  开头，会被认为是内置模块或第三方模块的模块名。</p>
<p>3）如果模块文件扩展名是 <code>.js</code> 或者是 <code>.json</code> ，在导入的时候可以省略扩展名。如果引入模块文件时，模块路径没有扩展名，会依次查找 <code>.js</code> 文件、<code>.json</code> 文件、目录。</p>
<h3 id="10-3-模块文件的扩展名"><a href="#10-3-模块文件的扩展名" class="headerlink" title="10.3 模块文件的扩展名"></a>10.3 模块文件的扩展名</h3><p>对于不同扩展名的模块文件，Node.js 有不同的处理方式</p>
<ul>
<li>扩展名是 <code>.js</code>的模块文件： 读取文件内容并编译执行并获取模块中暴露的数据。</li>
<li>扩展名是<code>.json</code>的模块文件： 读取文件，用 <code>JSON.parse()</code> 解析返回结果作为获取的数据。</li>
<li>扩展名是<code>.node</code>的模块文件： 这是 c&#x2F;c++ 编写的扩展文件，通过 <code>dlopen()</code> 方法编译。</li>
<li>其他扩展名，文件内容会被当做 JavaScript 代码去解析。</li>
</ul>
<h3 id="10-4-整个目录作为一个模块"><a href="#10-4-整个目录作为一个模块" class="headerlink" title="10.4 整个目录作为一个模块"></a>10.4 整个目录作为一个模块</h3><p>1）会默认加载该目录下 <code>package.json</code> 文件中 <code>main</code> 属性定义的入口文件。</p>
<p>2）如果没有package.json, 或者 <code>main</code> 属性对应的文件不存在，则自动找 <code>index.js</code> 、 <code>index.json</code> 作为入口文件。</p>
<h2 id="11-ES6-模块规范"><a href="#11-ES6-模块规范" class="headerlink" title="11 ES6 模块规范"></a>11 ES6 模块规范</h2><h3 id="11-1-Node-中使用-ES-模块规范"><a href="#11-1-Node-中使用-ES-模块规范" class="headerlink" title="11.1 Node 中使用 ES 模块规范"></a>11.1 Node 中使用 ES 模块规范</h3><p>Node.js 要求 ES6 模块采用<code>.mjs</code>后缀文件名。也就是说，只要脚本文件里面使用<code>import</code>或者<code>export</code>命令，那么就必须采用<code>.mjs</code>后缀名。</p>
<p>如果不希望将后缀名改成<code>.mjs</code>，可以在项目的<code>package.json</code>文件中，指定<code>type</code>字段为<code>module</code>。</p>
<h3 id="11-2-在模块中暴露数据"><a href="#11-2-在模块中暴露数据" class="headerlink" title="11.2 在模块中暴露数据"></a>11.2 在模块中暴露数据</h3><h4 id="①-暴露单个数据"><a href="#①-暴露单个数据" class="headerlink" title="① 暴露单个数据"></a>① 暴露单个数据</h4><p>使用 <code>export default</code> 可以在模块中暴露单个数据，注意文件中 <code>export default</code> 语句只能出现一次。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> data = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">50</span>];</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> data;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">say</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">eat</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  say,</span><br><span class="line">  eat</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="②-暴露多个数据"><a href="#②-暴露多个数据" class="headerlink" title="② 暴露多个数据"></a>② 暴露多个数据</h4><p>使用 <code>export</code> 可以暴露多个数据，有两种写法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一种写法 在声明变量的同时暴露</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> firstName = <span class="string">&#x27;Lee&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> lastName = <span class="string">&#x27;KeQiang&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> year = <span class="number">1918</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> obj = &#123;<span class="attr">name</span>:<span class="string">&#x27;mingge&#x27;</span>,<span class="attr">age</span>:<span class="number">100</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二种写法 在文件底部统一暴露（推荐）</span></span><br><span class="line"><span class="keyword">const</span> firstName = <span class="string">&#x27;Lee&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> lastName = <span class="string">&#x27;KeQiang&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> year = <span class="number">1918</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">name</span>:<span class="string">&#x27;mingge&#x27;</span>,<span class="attr">age</span>:<span class="number">100</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;firstName, lastName, year, fn, obj&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-3-引入模块并使用模块中暴露的数据"><a href="#11-3-引入模块并使用模块中暴露的数据" class="headerlink" title="11.3 引入模块并使用模块中暴露的数据"></a>11.3 引入模块并使用模块中暴露的数据</h3><h4 id="①-模块使用-export-default-暴露单个数据"><a href="#①-模块使用-export-default-暴露单个数据" class="headerlink" title="① 模块使用 export default 暴露单个数据"></a>① 模块使用 <code>export default</code> 暴露单个数据</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> 变量名 <span class="keyword">from</span> <span class="string">&#x27;模块地址&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="②-模块使用-export-暴露多个数据"><a href="#②-模块使用-export-暴露多个数据" class="headerlink" title="② 模块使用 export 暴露多个数据"></a>② 模块使用 <code>export</code> 暴露多个数据</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取的变量名必须与模块暴露的变量名一致，可以多次分别获取，可以取别名</span></span><br><span class="line"><span class="keyword">import</span> &#123;name, year <span class="keyword">as</span> y&#125; <span class="keyword">from</span> <span class="string">&#x27;模块地址&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;fn&#125; <span class="keyword">from</span> <span class="string">&#x27;模块地址&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以将模块中的数据整体加载</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> 别名 <span class="keyword">from</span> <span class="string">&#x27;模块地址&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">自定义模块，ES6方式，导入目录不行，需要把入口文件写在路径上</span><br></pre></td></tr></table></figure>

<h2 id="12-关于模块化规范"><a href="#12-关于模块化规范" class="headerlink" title="12 关于模块化规范"></a>12 关于模块化规范</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1. CommonJS 规范</span><br><span class="line">	CommonJS 是一种模块化规范，最初提出来是在浏览器以外的地方使用，并且当时命名为 ServerJS，后来为了体现它的广泛性，更名为 CommonJS，也可以简称为 CJS</span><br><span class="line">	Node 是 CommonJS 在服务端一个具有代表性的实现</span><br><span class="line">	Browserify 是 CommonJS 在浏览器端的一种实现</span><br><span class="line">	webpack 具备对 CommonJS 的支持与转换</span><br><span class="line">	</span><br><span class="line">2. AMD 规范</span><br><span class="line">	AMD 主要是应用于浏览器的一种模块化规范,AMD 是 Asynchronous Module Definition（异步模块定义）的缩写，它采用的是异步加载模块，事实上 AMD 的规范早于 CommonJS，但是现在 CommonJS 仍被使用，但 AMD 已经很少用了。</span><br><span class="line">	实现 AMD 规范的库主要是 require.js 和 curl.js</span><br><span class="line"></span><br><span class="line">3. CMD 规范</span><br><span class="line">	CMD 也是应用于浏览器的一种模块化规范，CMD 是 Common Module Definition（通用模块定义）的缩写，他也是采用了异步加载模块，但是它将 CommonJS 的优点吸收了过来，这个目前也很少使用了。</span><br><span class="line">	SeaJS 实现了 CMD 规范</span><br><span class="line"></span><br><span class="line">4. ES Module 规范</span><br><span class="line">   ES Module 规范是 ES 提出的，是官方的模块化规范。</span><br></pre></td></tr></table></figure>



<h2 id="13-异常处理语法"><a href="#13-异常处理语法" class="headerlink" title="13 异常处理语法"></a>13 异常处理语法</h2><h3 id="13-1-throw-主动抛出错误"><a href="#13-1-throw-主动抛出错误" class="headerlink" title="13.1 throw 主动抛出错误"></a>13.1 throw 主动抛出错误</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="number">100</span>;</span><br><span class="line"><span class="keyword">throw</span> <span class="string">&#x27;字符串&#x27;</span>;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;错误信息&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">抛出的错误与程序中的运行错误是一样，都可以终止后面代码的执行，也都可以被 try catch 捕获</span><br></pre></td></tr></table></figure>

<h3 id="13-2-try-catch-结构"><a href="#13-2-try-catch-结构" class="headerlink" title="13.2 try catch 结构"></a>13.2 try catch 结构</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> 	<span class="comment">// 各种语句   </span></span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;捕获到错误&#x27;</span>, error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. try 里面的语句一旦出现错误，不会将错误抛出，而是被 catch 捕获，由程序员自己决定如何处理该错误</span><br><span class="line">2. try 里面的错误不影响 try 外面语句的执行</span><br><span class="line">3. try ... catch 结构适合于容易出现异常的操作， 不适用于语法错误。</span><br></pre></td></tr></table></figure>





<h2 id="14-NPM"><a href="#14-NPM" class="headerlink" title="14 NPM"></a>14 NPM</h2><h3 id="14-1-NPM-的作用"><a href="#14-1-NPM-的作用" class="headerlink" title="14.1 NPM 的作用"></a>14.1 NPM 的作用</h3><p>通过 NPM 可以对 Node 的工具包进行搜索、下载、安装、删除、上传。借助别人写好的包，可以让我们的开发更加方便。</p>
<p>常见的使用场景有以下 3 种：</p>
<ul>
<li>允许用户从NPM服务器下载别人编写的第三方包到本地使用。</li>
<li>允许用户从NPM服务器下载并安装别人编写的命令行程序到本地使用。 </li>
<li>允许用户将自己编写的包上传到NPM服务器供别人使用。</li>
</ul>
<h3 id="14-2-NPM-操作"><a href="#14-2-NPM-操作" class="headerlink" title="14.2 NPM 操作"></a>14.2 NPM 操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看npm 版本</span></span><br><span class="line">npm -v</span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################</span></span><br><span class="line"><span class="comment"># 初始化 初始化会创建 package.json</span></span><br><span class="line">npm init</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################</span></span><br><span class="line"><span class="comment"># 安装包	包的信息会添加到 package.json 的依赖信息中</span></span><br><span class="line">npm install 包名</span><br><span class="line">npm i 包名</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装包  包的信息会添加到 package.json 的开发依赖信息中</span></span><br><span class="line">npm install 包名 --save-dev</span><br><span class="line">npm install 包名 -D</span><br><span class="line">npm i 包名 --save-dev</span><br><span class="line">npm i 包名 -D</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装指定版本的包</span></span><br><span class="line">npm install 包名@版本号</span><br><span class="line">npm i 包名@版本号</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局安装</span></span><br><span class="line">npm install -g 包名</span><br><span class="line">npm i -g 包名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################</span></span><br><span class="line"><span class="comment"># 移除包</span></span><br><span class="line">npm uninstall 包名</span><br><span class="line">npm uninstall -g 包名</span><br><span class="line">npm remove 包名</span><br><span class="line">npm remove -g 包名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################</span></span><br><span class="line"><span class="comment"># 显示已经安装的包</span></span><br><span class="line">npm list	</span><br><span class="line">npm list -g</span><br><span class="line">npm list -g --depth 0		<span class="comment"># 只显示一层，包依赖的包就不再显示</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################</span></span><br><span class="line"><span class="comment"># 显示那些包需要更新</span></span><br><span class="line">npm outdated</span><br><span class="line">npm outdated -g</span><br><span class="line"><span class="comment"># 更新包</span></span><br><span class="line">npm update 包名			<span class="comment"># 本地更新包，会受到 package.json 中 dependices 所设置的版本号的约束 </span></span><br><span class="line">npm update -g 包名		<span class="comment"># 全局更新包，直接更新到最新版</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################</span></span><br><span class="line"><span class="comment"># 强制清除缓存 （使用频率不高）</span></span><br><span class="line">npm cache clean --force</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################################################</span></span><br><span class="line"><span class="comment"># 安装依赖 根据 package.json 中的配置安装依赖</span></span><br><span class="line">npm install</span><br><span class="line">npm i</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只安装项目的依赖， 开发依赖不安装</span></span><br><span class="line">npm install --production</span><br><span class="line">npm i --production</span><br></pre></td></tr></table></figure>

<h3 id="14-3-package-json"><a href="#14-3-package-json" class="headerlink" title="14.3 package.json"></a>14.3 package.json</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;01-project&quot;</span><span class="punctuation">,</span>		<span class="comment">// 包名 注意：包名不能使用中文，大写 。 能使用 npm 作为包的名字</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span>		<span class="comment">// 版本</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span>		<span class="comment">// 描述信息</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span>	    <span class="comment">// 入口文件</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>				<span class="comment">// 可执行的名</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span>				<span class="comment">// 作者信息</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span><span class="punctuation">,</span>			<span class="comment">// 开源许可</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>			<span class="comment">// 依赖信息</span></span><br><span class="line">     <span class="attr">&quot;bootstrap&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.1.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;jquery&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.6.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span>，</span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>		<span class="comment">// 开发中的依赖</span></span><br><span class="line">     <span class="attr">&quot;babel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.23.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>版本号信息：</strong></p>
<ul>
<li>“^3.0.0” ：锁定大版本，以后安装包的时候，保证包是3.x.x版本，x默认取最新的。</li>
<li>“~3.1.x” ：锁定小版本，以后安装包的时候，保证包是3.1.x版本，x默认取最新的。</li>
<li>“3.1.1” ：锁定完整版本，以后安装包的时候，保证包必须是3.1.1版本。</li>
</ul>
<p><strong>package-lock.json 文件</strong></p>
<p>该文件记录包具体的版本信息，用于锁定版本。</p>
<h3 id="14-4-远程仓库与-npm-一起使用-的工作流程"><a href="#14-4-远程仓库与-npm-一起使用-的工作流程" class="headerlink" title="14.4 远程仓库与 npm 一起使用 的工作流程"></a>14.4 远程仓库与 npm 一起使用 的工作流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">前提：</span><br><span class="line">	仓库中将 node_modules 忽略，只同步 package.json</span><br><span class="line"></span><br><span class="line">上班第一天：</span><br><span class="line">	1. 从远程仓库克隆到本地</span><br><span class="line">	2. 进入项目目录，运行 npm install 安装依赖</span><br><span class="line">	3. 进行后续开发</span><br><span class="line">	4. 下班之前推送</span><br><span class="line">	</span><br><span class="line">以后上班每一天：	</span><br><span class="line">	1. 从远程仓库拉取</span><br><span class="line">	2. 进入项目目录，运行 npm install 安装依赖 （同事可能会安装了新的依赖）</span><br><span class="line">	3. 进行后续开发</span><br><span class="line">	4. 下班之前推送</span><br></pre></td></tr></table></figure>



<h3 id="14-5-如何在项目中使用第三方模块（重要）"><a href="#14-5-如何在项目中使用第三方模块（重要）" class="headerlink" title="14.5 如何在项目中使用第三方模块（重要）"></a>14.5 如何在项目中使用第三方模块（重要）</h3><h4 id="①-模块的查找过程"><a href="#①-模块的查找过程" class="headerlink" title="① 模块的查找过程"></a>① 模块的查找过程</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;模块名&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 先确定模块名路径是不是以 ./ 或者 ../ 开头，如果不是就认为是内置模块或者第三方模块</span><br><span class="line">2. 再确定有没有该内置模块，如果有该内置模块直接加载；如果没有该内置模块，判定为第三方模块</span><br><span class="line">3. 第三方模块加载过程：</span><br><span class="line">   ① 先从脚本本就所在的目录中查找有没有 node_modules 目录，如果有进入查找模块</span><br><span class="line">   ② 如果脚本同级目录没有 node_modules 目录，去上级目录查找 node_modules 目录，如果有进入查找模块</span><br><span class="line">   ③ 以此类推，一直查找到 根目录</span><br></pre></td></tr></table></figure>

<h4 id="②-在后端项目中使用"><a href="#②-在后端项目中使用" class="headerlink" title="② 在后端项目中使用"></a>② 在后端项目中使用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">后端项目的代码运行在 node</span><br><span class="line">安装了第三方模块之后，直接在脚本中引入模块</span><br></pre></td></tr></table></figure>

<h4 id="③-在前端项目中使用"><a href="#③-在前端项目中使用" class="headerlink" title="③ 在前端项目中使用"></a>③ 在前端项目中使用</h4><p><strong>非工程化开发的前端项目：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">不需要 npm！</span><br></pre></td></tr></table></figure>

<p><strong>工程化开发的前端项目：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 前端项目的代码需要运行在浏览器上</span><br><span class="line">2. 开发的时候，需要写很多浏览器本身不支持的代码（如 模块），开发完成后编译成浏览器支持的代码，再在浏览器上运行</span><br><span class="line">3. 前端项目本身不需要node，但是开发过程 中用到的各种工具需要node的支持，这些工具需要 npm 进行管理</span><br></pre></td></tr></table></figure>



<h2 id="15-包管理工具"><a href="#15-包管理工具" class="headerlink" title="15 包管理工具"></a>15 包管理工具</h2><h3 id="14-1-cnpm"><a href="#14-1-cnpm" class="headerlink" title="14.1 cnpm"></a>14.1 cnpm</h3><p>使用国内的镜像作为 npm 源</p>
<p>方式一：全局安装 cnpm 命令，安装完成后使用 <code>cnpm </code> 命令代替 <code>npm</code> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>

<p>方式二：通过添加 <code>npm</code> 参数 <code>alias</code> 一个新命令，安装完成后使用 <code>cnpm </code> 命令代替 <code>npm</code> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> cnpm=<span class="string">&quot;npm --registry=https://registry.npm.taobao.org \</span></span><br><span class="line"><span class="string">--cache=HOME/.npm/.cache/cnpm \</span></span><br><span class="line"><span class="string">--disturl=https://npm.taobao.org/dist \</span></span><br><span class="line"><span class="string">--userconfig=HOME/.cnpmrc&quot;</span></span><br></pre></td></tr></table></figure>

<p>方式三：把官方镜像地址修改为淘宝镜像地址，修改后继续使用 <code>npm 命令</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置为淘宝镜像</span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果想改回官方镜像   </span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmjs.org/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改了镜像地址之后，直接用 <code>npm</code> 命令就可以了。</p>
</blockquote>
<h3 id="15-2-yarn"><a href="#15-2-yarn" class="headerlink" title="15.2 yarn"></a>15.2 yarn</h3><p>yarn 命令可以代替 npm， 安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install yarn -g</span><br></pre></td></tr></table></figure>

<p>yarn 相比于 npm 有几个特点：</p>
<ul>
<li>本地缓存。安装过的包下次不会进行远程安装</li>
<li>并行下载。一次下载多个包，而 npm 是串行下载</li>
<li>精准的版本控制。保证每次安装跟上次都是一样的</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">yarn --version</span><br><span class="line"></span><br><span class="line">yarn init  <span class="comment"># 初始化包 生成package.json   </span></span><br><span class="line"></span><br><span class="line">yarn add 包名 <span class="comment"># 安装包</span></span><br><span class="line"></span><br><span class="line">yarn add 包名 --dev    <span class="comment"># 相当于 npm 中的--save-dev</span></span><br><span class="line">yarn add 包名 -D</span><br><span class="line"></span><br><span class="line">yarn global add  包名 <span class="comment">#全局安装  全局安装路径 C:\Users\你的用户名\AppData\Local\Yarn\bin</span></span><br><span class="line"></span><br><span class="line">yarn remove 包名 <span class="comment"># 移除包</span></span><br><span class="line">yarn global remove 包名  <span class="comment">#移除全局包</span></span><br><span class="line"></span><br><span class="line">yarn <span class="comment"># 安装 package.json中的所有依赖 </span></span><br><span class="line"></span><br><span class="line">yarn config <span class="built_in">set</span> registry https://registry.npm.taobao.org  <span class="comment"># yarn 修改镜像地址</span></span><br></pre></td></tr></table></figure>

<h3 id="15-3-cyarn"><a href="#15-3-cyarn" class="headerlink" title="15.3 cyarn"></a>15.3 cyarn</h3><p>yarn 也可以使用淘宝镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cyarn -g --registry <span class="string">&quot;https://registry.npm.taobao.org&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="15-4-同时暴露-CommonJS-和-ES6-模块的模块"><a href="#15-4-同时暴露-CommonJS-和-ES6-模块的模块" class="headerlink" title="15.4 同时暴露 CommonJS 和 ES6 模块的模块"></a>15.4 同时暴露 CommonJS 和 ES6 模块的模块</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 创建两个入口文件，一个暴露 CommonJS 规范的数据，以暴露 ES6 模块规范的数据</span><br><span class="line">2. package.json 中 main 属性设置 commonJS 规范的入口文件， export 属性设置 ES6 模块规范的入口文件</span><br><span class="line">3. 在使用该模块的时候，即可以使用 require 也可以使用 import</span><br></pre></td></tr></table></figure>



<h2 id="16-发布-npm-包"><a href="#16-发布-npm-包" class="headerlink" title="16 发布 npm 包"></a>16 发布 npm 包</h2><h3 id="16-1-发布步骤"><a href="#16-1-发布步骤" class="headerlink" title="16.1 发布步骤"></a>16.1 发布步骤</h3><p><strong>第一步 本地开发好包内容</strong></p>
<ol>
<li><code>npm init</code> 进行初始化</li>
<li>开发包的内容， <code>module.exports</code> 暴露数据</li>
</ol>
<p><strong>第二步 注册账号并在命令行登录</strong></p>
<ol>
<li>npmjs.org 官网注册账号</li>
<li>命令行登录账户  <code>npm login</code></li>
</ol>
<blockquote>
<p>如果修改过官方的镜像地址，得改回来  <code>npm config set registry https://registry.npmjs.org/</code></p>
</blockquote>
<p><strong>第三步 发布</strong></p>
<ol>
<li><p>发布 <code>npm publish</code></p>
</li>
<li><p>如果要更新，先修改 package.json 中的版本号，再发布</p>
</li>
</ol>
<h3 id="16-2-发布全局命令"><a href="#16-2-发布全局命令" class="headerlink" title="16.2 发布全局命令"></a>16.2 发布全局命令</h3><p>第一步 创建命令行执行的脚步文件，第一行代码写 <code>#!/usr/bin/env node</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	这里是运行命令时候要执行的代码</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>第二步 在 <code>package.json</code> 文件中配置 <code>bin</code> 字段</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;bin&quot;</span>: &#123;</span><br><span class="line">     <span class="string">&quot;命令名&quot;</span>: <span class="string">&quot;刚才创建的脚b文件路径&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="17-网络协议简述"><a href="#17-网络协议简述" class="headerlink" title="17 网络协议简述"></a>17 网络协议简述</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">OSI 七层模型：</span><br><span class="line">	应用层 会话层 表示层 传输层 网络层 数据链路层 物理层</span><br><span class="line">	</span><br><span class="line">TCP/IP 四层模型</span><br><span class="line">	应用层	传输层 网络层 网络接口层</span><br><span class="line">	</span><br><span class="line">各层的网络协议：</span><br><span class="line">	应用层： http、https、ssh、ftp、telnet、smtp、pop3 等等</span><br><span class="line">	传输层： tcp、udp</span><br><span class="line">	网络层： ip</span><br><span class="line">	网络接口层： USB协议、网线接口协议 等等</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">IP 地址：</span><br><span class="line">	IP 地址是IP 协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个地址。在一个网络中，每台主机的 IP 地址都是唯一的。</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">域名：</span><br><span class="line">	域名是 IP 地址的映射</span><br><span class="line">	</span><br><span class="line">DNS 服务器：</span><br><span class="line">	用来找出域名对应的 IP 地址</span><br><span class="line">	</span><br><span class="line">端口号</span><br><span class="line">	每个应用程序都有一个端口号，通过端口号可以确定计算机上的某个应用程序</span><br><span class="line">	0-1023 是公认端口号，即已经公认定义或为将要公认定义的软件保留的。</span><br><span class="line">	1024-65535 是并没有公认定义的端口号，用户可以自己定义这些端口的作用。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="18-HTTP-协议"><a href="#18-HTTP-协议" class="headerlink" title="18 HTTP 协议"></a>18 HTTP 协议</h2><h3 id="18-1-请求报文"><a href="#18-1-请求报文" class="headerlink" title="18.1 请求报文"></a>18.1 请求报文</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">请求行</span><br><span class="line">GET https://www.baidu.com/ HTTP/1.1		</span><br><span class="line"></span><br><span class="line">请求头</span><br><span class="line">Host: www.baidu.com</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot; Not A;Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;102&quot;, &quot;Google Chrome&quot;;v=&quot;102&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.62 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7,en-US;q=0.6</span><br><span class="line"></span><br><span class="line">空行</span><br><span class="line"></span><br><span class="line">请求体</span><br></pre></td></tr></table></figure>

<h4 id="①-请求行"><a href="#①-请求行" class="headerlink" title="① 请求行"></a>① 请求行</h4><p><strong>请求方法：</strong> GET、POST …</p>
<p><strong>URL</strong> ： 统一资源定位符</p>
<p>**协议版本： ** HTTP&#x2F;1.1	</p>
<h4 id="②-请求头"><a href="#②-请求头" class="headerlink" title="② 请求头"></a>② 请求头</h4><p>请求头格式，<code>请求头键名：值</code>。</p>
<h4 id="③-空行"><a href="#③-空行" class="headerlink" title="③ 空行"></a>③ 空行</h4><p>隔开请求头和请求体</p>
<h4 id="④-请求体"><a href="#④-请求体" class="headerlink" title="④ 请求体"></a>④ 请求体</h4><p>客户端向服务器发送的数据，可以放在请求体中</p>
<h3 id="18-2-响应报文"><a href="#18-2-响应报文" class="headerlink" title="18.2 响应报文"></a>18.2 响应报文</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">响应行</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">响应头</span><br><span class="line">Bdpagetype: 1</span><br><span class="line">Bdqid: 0xc7ed2b9a000154e9</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Date: Sat, 28 May 2022 07:05:11 GMT</span><br><span class="line">Server: BWS/1.1</span><br><span class="line">Set-Cookie: BDSVRTM=1; path=/</span><br><span class="line">Set-Cookie: BD_HOME=1; path=/</span><br><span class="line">Set-Cookie: H_PS_PSSID=36460_36454_31253_36453_35914_36166_36487_36055_36346_26350_36301_36468_36311; path=/; domain=.baidu.com</span><br><span class="line">Strict-Transport-Security: max-age=172800</span><br><span class="line">Traceid: 1653721511063568641014406218723453129961</span><br><span class="line">X-Frame-Options: sameorigin</span><br><span class="line">X-Ua-Compatible: IE=Edge,chrome=1</span><br><span class="line">Content-Length: 358160</span><br><span class="line"></span><br><span class="line">空行</span><br><span class="line"></span><br><span class="line">响应体</span><br><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot;&gt;&lt;meta content=&quot;always&quot; name=&quot;referrer&quot;&gt;&lt;meta name=&quot;theme-color&quot; content=&quot;#ffffff&quot;&gt;</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="①-响应行"><a href="#①-响应行" class="headerlink" title="① 响应行"></a>① 响应行</h4><p><strong>协议版本：</strong> HTTP&#x2F;1.1</p>
<p><strong>响应状态码：</strong> 用数字表示响应状态。</p>
<p><strong>响应状态码描述：</strong> 用字符串表示响应状态。</p>
<h4 id="②-响应头"><a href="#②-响应头" class="headerlink" title="② 响应头"></a>② 响应头</h4><p>响应头格式，<code>请求头键名：值</code>。</p>
<h4 id="③-空行-1"><a href="#③-空行-1" class="headerlink" title="③ 空行"></a>③ 空行</h4><p>分隔响应头和响应体</p>
<h4 id="④-响应体"><a href="#④-响应体" class="headerlink" title="④  响应体"></a>④  响应体</h4><p>服务器返回给客户端的内容</p>
<h3 id="18-3-请求方式-GET-和-POST-的区别："><a href="#18-3-请求方式-GET-和-POST-的区别：" class="headerlink" title="18.3 请求方式 GET 和 POST 的区别："></a>18.3 请求方式 GET 和 POST 的区别：</h3><p>GET 和 POST 是最常见的两种请求方式，两者具有如下区别：</p>
<ul>
<li>GET 主要用来获取数据, POST 主要用来提交数据。通过浏览器访问网页用的就是 GET 请求。</li>
<li>GET 如果带参数，将参数放到 URL 之后, POST 带参数请求是将参数放到请求体中。GET 方式没有请求体</li>
<li>POST 请求相对 GET 安全一些, 因为GET请求在浏览器中参数会暴露在地址栏。</li>
<li>GET 请求大小有限制, 一般为 <code>2k,</code> 而 POST 请求则没有大小限制。</li>
</ul>
<h3 id="18-4-URL"><a href="#18-4-URL" class="headerlink" title="18.4 URL"></a>18.4 URL</h3><p>统一资源定位系统（uniform resource locator;URL）是因特网的万维网服务程序上用于指定信息位置的表示方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.baidu.com:8080/home/msg/data/personalcontent?num=8&amp;indextype=manht#logo</span><br></pre></td></tr></table></figure>

<p>完整 URL 的组成部分：</p>
<ul>
<li>协议 ，如 https、http。</li>
<li>主机名，一般使用 IP 地址或域名。</li>
<li>端口号 ，HTTP 的端口号为 80，HTTPS 的为 443</li>
<li>路径，上面 URL 中的路径部分为： <code>/home/msg/data/personalcontent</code>。</li>
<li>查询字符串，上面 URL 中的路径部分为：<code>num=8&amp;indextype=manht</code>。</li>
<li>锚点，上面 URL 中的路径部分为：<code>#logo</code></li>
</ul>
<h3 id="18-5-HTTP-响应状态码"><a href="#18-5-HTTP-响应状态码" class="headerlink" title="18.5 HTTP 响应状态码"></a>18.5 HTTP 响应状态码</h3><p>状态码由三位数字组成，第一位数字表示响应的类型，常用的状态码有五大类如下所示：</p>
<ul>
<li><code>1xx</code>：指示信息–表示请求已接收，继续处理。</li>
<li><code>2xx</code>：成功–表示请求已被成功接收、理解、接受。</li>
<li><code>3xx</code>：重定向–要完成请求必须进行更进一步的操作。</li>
<li><code>4xx</code>：客户端错误–请求有语法错误或请求无法实现。</li>
<li><code>5xx</code>：服务器端错误–服务器未能实现合法的请求。</li>
</ul>
<p>常见状态代码、状态描述的说明如下。</p>
<ul>
<li><p>200 OK：客户端请求成功。</p>
</li>
<li><p>400 Bad Request：客户端请求有语法错误，不能被服务器所理解。</p>
</li>
<li><p>401 Unauthorized：请求未经授权</p>
</li>
<li><p>403 Forbidden：服务器收到请求，但是拒绝提供服务。</p>
</li>
<li><p>404 Not Found：请求资源不存在，举个例子：输入了错误的URL。</p>
</li>
<li><p>500 Internal Server Error：服务器发生不可预期的错误。</p>
</li>
<li><p>503 Server Unavailable：服务器当前不能处理客户端的请求，一段时间后可能恢复正常</p>
</li>
</ul>
<h2 id="19-使用-node-创建-http-服务"><a href="#19-使用-node-创建-http-服务" class="headerlink" title="19 使用 node 创建 http 服务"></a>19 使用 node 创建 http 服务</h2><h3 id="19-1-创建服务"><a href="#19-1-创建服务" class="headerlink" title="19.1 创建服务"></a>19.1 创建服务</h3><p>写一个程序，该程序可以接收到客户端浏览器的请求，并能为客户端浏览器做出响应； 该程序是后端程序，运行在服务器上，需要 node 的支持。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入http模块</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 http 服务（程序）</span></span><br><span class="line"><span class="comment">// http.createServer 需要一个回调函数作为参数，当有客户端像该服务请求的时候，回调函数会触发</span></span><br><span class="line"><span class="comment">// 回调函数被调用的时候，会接收到两个参数，分别是请求对象和响应对象</span></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;啊，有人在向我请求！&#x27;</span>);</span><br><span class="line">    <span class="comment">// 设置响应内容并且结束响应</span></span><br><span class="line">    response.<span class="title function_">end</span>(<span class="string">&#x27;Welcome to Shanghai&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启服务 需要设置端口号和回调函数</span></span><br><span class="line"><span class="comment">// 服务成功开启之后，回调函数会被触发</span></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8090</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;http 启动成功！ 端口号 8090&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. http 对象， 导入的 http 内置模块</span><br><span class="line">2. http.Server 对象， http.createServer() 的返回值</span><br><span class="line">3. http.clientRequest 对象， http.createServer() 的回调函数的第一个参数</span><br><span class="line">4. http.serverResponse 对象， http.createServer() 的回调函数的第二个参数</span><br></pre></td></tr></table></figure>

<p><strong>注意：如果启动服务的时候，报错提示端口被占用，可以采用下面两种方案来解决：</strong></p>
<p>1）给我们的程序换个端口</p>
<p>2）把占用端口的其他程序关闭</p>
<ul>
<li>windows cmd 命令行中运行命令 <code>netstat -ano | findstr 端口号</code> 来获取占用端口的程序的进程ID</li>
<li>资源管理器-&gt;详细信息，根据进程ID找到程序，右键选择结束任务。</li>
</ul>
<h3 id="19-2-获取请求报文信息"><a href="#19-2-获取请求报文信息" class="headerlink" title="19.2 获取请求报文信息"></a>19.2 获取请求报文信息</h3><h4 id="获取请求行的信息"><a href="#获取请求行的信息" class="headerlink" title="获取请求行的信息"></a>获取请求行的信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">method</span>		<span class="comment">// 请求方法</span></span><br><span class="line">request.<span class="property">url</span>			<span class="comment">// 获取URL</span></span><br><span class="line">request.<span class="property">httpVersion</span>	<span class="comment">// 获取协议版本</span></span><br></pre></td></tr></table></figure>

<h4 id="获取请求头信息"><a href="#获取请求头信息" class="headerlink" title="获取请求头信息"></a>获取请求头信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">headers</span>				<span class="comment">// 返回所有请求头组成的对象</span></span><br><span class="line">request.<span class="property">headers</span>.请求名称	  <span class="comment">// 获取指定的请求头信息</span></span><br></pre></td></tr></table></figure>





<h2 id="20-http-服务"><a href="#20-http-服务" class="headerlink" title="20 http 服务"></a>20 http 服务</h2><h3 id="20-1-创建服务"><a href="#20-1-创建服务" class="headerlink" title="20.1 创建服务"></a>20.1 创建服务</h3><p>写一个程序，该程序可以接收到客户端浏览器的请求，并能为客户端浏览器做出响应； 该程序是后端程序，运行在服务器上，需要 node 的支持。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入http模块</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 http 服务（程序）</span></span><br><span class="line"><span class="comment">// http.createServer 需要一个回调函数作为参数，当有客户端像该服务请求的时候，回调函数会触发</span></span><br><span class="line"><span class="comment">// 回调函数被调用的时候，会接收到两个参数，分别是请求对象和响应对象</span></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;啊，有人在向我请求！&#x27;</span>);</span><br><span class="line">    <span class="comment">// 设置响应内容并且结束响应</span></span><br><span class="line">    response.<span class="title function_">end</span>(<span class="string">&#x27;Welcome to Shanghai&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启服务 需要设置端口号和回调函数</span></span><br><span class="line"><span class="comment">// 服务成功开启之后，回调函数会被触发</span></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8090</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;http 启动成功！ 端口号 8090&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. http 对象， 导入的 http 内置模块</span><br><span class="line">2. http.Server 对象， http.createServer() 的返回值</span><br><span class="line">3. http.clientRequest 对象， http.createServer() 的回调函数的第一个参数</span><br><span class="line">4. http.serverResponse 对象， http.createServer() 的回调函数的第二个参数</span><br></pre></td></tr></table></figure>

<p><strong>注意：如果启动服务的时候，报错提示端口被占用，可以采用下面两种方案来解决：</strong></p>
<p>1）给我们的程序换个端口</p>
<p>2）把占用端口的其他程序关闭</p>
<ul>
<li>windows cmd 命令行中运行命令 <code>netstat -ano | findstr 端口号</code> 来获取占用端口的程序的进程ID</li>
<li>资源管理器-&gt;详细信息，根据进程ID找到程序，右键选择结束任务。</li>
</ul>
<h3 id="20-2-获取请求报文信息"><a href="#20-2-获取请求报文信息" class="headerlink" title="20.2 获取请求报文信息"></a>20.2 获取请求报文信息</h3><h4 id="获取请求行的信息-1"><a href="#获取请求行的信息-1" class="headerlink" title="获取请求行的信息"></a>获取请求行的信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">httpVersion</span>;		<span class="comment">// 获取 http 版本</span></span><br><span class="line">request.<span class="property">url</span>;				<span class="comment">// 获取请求的 url 地址</span></span><br><span class="line">request.<span class="property">method</span>;				<span class="comment">// 获取请求方式（请求方法）</span></span><br></pre></td></tr></table></figure>

<h4 id="获取请求头信息-1"><a href="#获取请求头信息-1" class="headerlink" title="获取请求头信息"></a>获取请求头信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">headers</span>;			<span class="comment">// 返回对象，包含请求报文中所有的请求头信息</span></span><br><span class="line">request.<span class="property">headers</span>.请求头名字；</span><br></pre></td></tr></table></figure>

<h4 id="获取客户端-IP-地址"><a href="#获取客户端-IP-地址" class="headerlink" title="获取客户端 IP 地址"></a>获取客户端 IP 地址</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">socket</span>.<span class="property">remoteAddress</span></span><br></pre></td></tr></table></figure>

<h4 id="获取-URL-中的查询字符串"><a href="#获取-URL-中的查询字符串" class="headerlink" title="获取 URL 中的查询字符串"></a>获取 URL 中的查询字符串</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line">url.<span class="title function_">parse</span>(request.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>;  <span class="comment">// 返回一个对象</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(url.<span class="title function_">parse</span>(urlString[, parseQueryString[, slashesDenoteHost]])：</span><br><span class="line">parseQueryString &lt;boolean&gt; 如果为 <span class="literal">true</span>，则 query 属性将始终设置为 querystring 模块的 <span class="title function_">parse</span>() 方法返回的对象。 如果为 <span class="literal">false</span>，则返回的网址对象上的 query 属性将是未解析、未解码的字符串。 默认值: <span class="literal">false</span>。）</span><br><span class="line"></span><br><span class="line">querystring.<span class="title function_">parse</span>() 方法将网址查询字符串 (str) 解析为键值对的集合。</span><br><span class="line">例如，查询字符串 <span class="string">&#x27;foo=bar&amp;abc=xyz&amp;abc=123&#x27;</span> 被解析为：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">  <span class="attr">abc</span>: [<span class="string">&#x27;xyz&#x27;</span>, <span class="string">&#x27;123&#x27;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">不论是 GET 请求是 POST 请求,URL 中都可以有查询字符串。</span><br></pre></td></tr></table></figure>

<h4 id="获取请求体信息"><a href="#获取请求体信息" class="headerlink" title="获取请求体信息"></a>获取请求体信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// request 本质上是一个可读流对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义变量 将请求体中读取的内容拼接到该变量</span></span><br><span class="line"><span class="keyword">let</span> reqBody = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分次从请求体中读取数据</span></span><br><span class="line">req.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function"><span class="params">chunk</span> =&gt;</span> &#123;</span><br><span class="line">    reqBody += chunk;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求体内容读取结束</span></span><br><span class="line">req.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">   	reqBody;  					 <span class="comment">// 查询字符串</span></span><br><span class="line">    querystring.<span class="title function_">parse</span>(reqBody);   <span class="comment">// 解析为对象</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET 请求方式没有请求体，POST 请求方式有请求体</span><br></pre></td></tr></table></figure>

<h3 id="20-3-设置响应报文"><a href="#20-3-设置响应报文" class="headerlink" title="20.3 设置响应报文"></a>20.3 设置响应报文</h3><h4 id="设置响应行"><a href="#设置响应行" class="headerlink" title="设置响应行"></a>设置响应行</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.<span class="property">statusCode</span> = <span class="number">200</span>;		<span class="comment">// 设置响应状态码</span></span><br><span class="line">response.<span class="property">statusMessage</span> = <span class="string">&#x27;OK&#x27;</span>;	<span class="comment">// 设置响应状态描述</span></span><br></pre></td></tr></table></figure>

<h4 id="设置响应头"><a href="#设置响应头" class="headerlink" title="设置响应头"></a>设置响应头</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.<span class="title function_">setHeader</span>(<span class="string">&#x27;响应头名字&#x27;</span>， <span class="string">&#x27;响应头内容&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同时设置 响应状态码、设置响应状态描述、响应头</span></span><br><span class="line">response.<span class="title function_">writeHead</span>(响应状态码, <span class="string">&#x27;响应状态描述&#x27;</span>, &#123;</span><br><span class="line">    <span class="string">&#x27;响应头名字&#x27;</span> ：<span class="string">&#x27;响应头内容&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;响应头名字&#x27;</span> ：<span class="string">&#x27;响应头内容&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;响应头名字&#x27;</span> ：<span class="string">&#x27;响应头内容&#x27;</span></span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="设置响应体"><a href="#设置响应体" class="headerlink" title="设置响应体"></a>设置响应体</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// resposne 本质上是一个可写流对象 可以通过 write 将内容写入流</span></span><br><span class="line">response.<span class="title function_">write</span>(<span class="string">&#x27;内容&#x27;</span>);</span><br><span class="line">response.<span class="title function_">write</span>(<span class="string">&#x27;内容&#x27;</span>);</span><br><span class="line">response.<span class="title function_">write</span>(<span class="string">&#x27;内容&#x27;</span>);</span><br><span class="line">response.<span class="title function_">write</span>(<span class="string">&#x27;内容&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="结束响应"><a href="#结束响应" class="headerlink" title="结束响应"></a>结束响应</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只用来结束响应</span></span><br><span class="line">resposne.<span class="title function_">end</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置响应体并结束响应</span></span><br><span class="line">response.<span class="title function_">end</span>(<span class="string">&#x27;响应体内容&#x27;</span>);</span><br></pre></td></tr></table></figure>





<h2 id="22-http-服务案例"><a href="#22-http-服务案例" class="headerlink" title="22 http 服务案例"></a>22 http 服务案例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 根据路径不同做出不同响应(路由)</span><br><span class="line">2. 响应静态文件</span><br><span class="line">3. 根据请求方式不同做出不同的响应</span><br></pre></td></tr></table></figure>



<h2 id="23-Express-概述"><a href="#23-Express-概述" class="headerlink" title="23 Express 概述"></a>23 Express 概述</h2><h3 id="23-1-什么是-Express"><a href="#23-1-什么是-Express" class="headerlink" title="23.1 什么是 Express"></a>23.1 什么是 Express</h3><p>Express 是一个基于 Node.js 平台的极简、灵活的 web 应用开发框架，它提供一系列强大的特性，帮助你快速创建各种 Web 和移动设备应用。 Express 中的<strong>路由</strong>和<strong>中间件</strong>为我们的开发带来极大便利。</p>
<p>简单来说， Express 就是一个第三方模块，专门用来创建 HTTP服务。</p>
<h3 id="23-2-相关网站"><a href="#23-2-相关网站" class="headerlink" title="23.2 相关网站"></a>23.2 相关网站</h3><ul>
<li>官网： <a target="_blank" rel="noopener" href="http://expressjs.com/">http://expressjs.com/</a></li>
<li>中文网：<a target="_blank" rel="noopener" href="https://www.expressjs.com.cn/">https://www.expressjs.com.cn/</a></li>
<li>Github: <a target="_blank" rel="noopener" href="https://github.com/expressjs/express">https://github.com/expressjs/express</a></li>
</ul>
<h3 id="23-3-安装"><a href="#23-3-安装" class="headerlink" title="23.3 安装"></a>23.3 安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express;</span><br></pre></td></tr></table></figure>

<h3 id="23-4-基本使用"><a href="#23-4-基本使用" class="headerlink" title="23.4 基本使用"></a>23.4 基本使用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 express 应用</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用内置的中间件 express.static() 托管静态文件 指定静态文件所在的目录</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配 GET /index.html</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/index&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    response.<span class="title function_">send</span>(<span class="string">&#x27;&lt;h1&gt;首页&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配 GET /login</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    response.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;pages&#x27;</span>, <span class="string">&#x27;login.html&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配 POST /login</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    response.<span class="title function_">send</span>(<span class="string">&#x27;提交成功！&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动 http 服务指定端口</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8080</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;express server is running on :8080&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="24-路由"><a href="#24-路由" class="headerlink" title="24 路由"></a>24 路由</h2><h3 id="24-1-路由方法"><a href="#24-1-路由方法" class="headerlink" title="24.1 路由方法"></a>24.1 路由方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.get()		接收 get 请求</span><br><span class="line">app.post()		接收 post 请求</span><br><span class="line">app.put()</span><br><span class="line">app.head()</span><br><span class="line">app.delete()</span><br><span class="line">app.options()</span><br><span class="line">app.trace()</span><br><span class="line">app.connect()</span><br><span class="line">app.all()		接收所有的请求</span><br></pre></td></tr></table></figure>

<h3 id="24-2-路径匹配"><a href="#24-2-路径匹配" class="headerlink" title="24.2 路径匹配"></a>24.2 路径匹配</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. URL 中的 pathname 需要与路由方法进行匹配，匹配成功才能执行对应的回调函数</span><br><span class="line">2. URL 中只有 pathname 参与匹配，查询字符串会被剔除</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 精确匹配，只能匹配 /home/index</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/home/index&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;&lt;h1&gt;这里是首页&lt;/h1&gt;&#x27;</span> + req.<span class="property">url</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串模糊匹配</span></span><br><span class="line"><span class="comment">// app.get(&#x27;/home(ab)?&#x27;, (req, res) =&gt; &#123;</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin/*&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;&lt;h1&gt;这里是字符串的模糊匹配&lt;/h1&gt;&#x27;</span> + req.<span class="property">url</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正则模糊匹配</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="regexp">/\.html$/</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;&lt;h1&gt;正则的模糊匹配成功！&lt;/h1&gt;&#x27;</span> + req.<span class="property">url</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// URL中带参数  /news/23112  /news/abab</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/news/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;&lt;h1&gt;带参数的路径！&lt;/h1&gt;&#x27;</span> + req.<span class="property">params</span>.<span class="property">id</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串的模糊匹配 * 表示任意数量的任意字符</span></span><br><span class="line"><span class="comment">// 写在最后，如果前面的路由都没有匹配到 设置 404 页面</span></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;*&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">send</span>(<span class="string">&#x27;&lt;h1&gt;404 您要找的页面不存在！&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="24-3-路由回调函数"><a href="#24-3-路由回调函数" class="headerlink" title="24.3 路由回调函数"></a>24.3 路由回调函数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 路由方法可以设置回调函数，当url与该路由匹配的时候，调用回调函数，回调函数接收两个参数，分别请求对象和响应对象</span><br><span class="line"><span class="number">2.</span> 一个路由方法可以设置多个回调函数</span><br></pre></td></tr></table></figure>

<h3 id="24-4-app-route"><a href="#24-4-app-route" class="headerlink" title="24.4 app.route()"></a>24.4 app.route()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">route</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    .<span class="title function_">get</span>(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">        response.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;pages&#x27;</span>, <span class="string">&#x27;login.html&#x27;</span>));</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">post</span>(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">        response.<span class="title function_">send</span>(<span class="string">&#x27;提交成功！&#x27;</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>



<h2 id="25-请求对象和响应对象"><a href="#25-请求对象和响应对象" class="headerlink" title="25 请求对象和响应对象"></a>25 请求对象和响应对象</h2><h3 id="25-1-请求对象"><a href="#25-1-请求对象" class="headerlink" title="25.1 请求对象"></a>25.1 请求对象</h3><p>request 对象是路由回调函数中的第一个参数，代表了用户发送给服务器的请求信息，通过 request 对象可以读取用户发送的请求包括 URL 地址中的查询字符串中的参数，和 post 请求的请求体中的参数。</p>
<h4 id="获取客户端-IP"><a href="#获取客户端-IP" class="headerlink" title="获取客户端 IP"></a>获取客户端 IP</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">ip</span></span><br></pre></td></tr></table></figure>

<h4 id="获取请求头"><a href="#获取请求头" class="headerlink" title="获取请求头"></a>获取请求头</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="title function_">get</span>(<span class="string">&#x27;请求头key&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="查询字符串信息"><a href="#查询字符串信息" class="headerlink" title="查询字符串信息"></a>查询字符串信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">query</span>;  <span class="comment">// 获取一个对象</span></span><br></pre></td></tr></table></figure>

<h4 id="路径中的参数信息"><a href="#路径中的参数信息" class="headerlink" title="路径中的参数信息"></a>路径中的参数信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路径中的参数信息 代替 查询字符串  匹配 /news/20342323/a12.shtml</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/news/:date/:id.shtml&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h1&gt;news&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;date： <span class="subst">$&#123;request.params.date&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;id： <span class="subst">$&#123;request.params.id&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(request.<span class="property">params</span>);  <span class="comment">// 对象 date 和 id 是属性名</span></span><br><span class="line">    response.<span class="title function_">send</span>(data);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="获取请求体"><a href="#获取请求体" class="headerlink" title="获取请求体"></a>获取请求体</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.body 必须经过中间件的处理才能获取到请求体数据解析成的对象，否则只能得到 undefined</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 express 应用</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 body-parser 解析请求体内容</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(request.<span class="property">body</span>);  <span class="comment">// 对象</span></span><br><span class="line">    response.<span class="title function_">send</span>(<span class="string">&#x27;提交成功！&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="25-2-响应对象"><a href="#25-2-响应对象" class="headerlink" title="25.2 响应对象"></a>25.2 响应对象</h3><p>response 对象是路由回调函数中的第二个参数，代表了服务器发送给用户的响应信息，通过 response 对象可以设置响应报文中的各个内容，包括响应头和响应体。</p>
<h4 id="设置响应状态码"><a href="#设置响应状态码" class="headerlink" title="设置响应状态码"></a>设置响应状态码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.<span class="title function_">status</span>(<span class="number">404</span>);</span><br></pre></td></tr></table></figure>

<h4 id="设置响应头-1"><a href="#设置响应头-1" class="headerlink" title="设置响应头"></a>设置响应头</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.<span class="title function_">set</span>(<span class="string">&#x27;响应头key&#x27;</span>, <span class="string">&#x27;值&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="设置响应体-1"><a href="#设置响应体-1" class="headerlink" title="设置响应体"></a>设置响应体</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">response.end()</span><br><span class="line">response.send()				比起 end() 可以自动追加 Content-type 响应头</span><br><span class="line">response.sendFile(文件地址)	  将文件中的内容读取作为响应体</span><br><span class="line">response.download(文件地址)	  将文件下载</span><br><span class="line">response.json()				将对象转为json字符串，进行响应</span><br><span class="line">response.jsonp()			将对象转为jsonp调用形式，进行响应</span><br><span class="line">response.render()			渲染模板</span><br></pre></td></tr></table></figure>

<h4 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.redirect()			重定向</span><br></pre></td></tr></table></figure>



<h2 id="26-中间件"><a href="#26-中间件" class="headerlink" title="26 中间件"></a>26 中间件</h2><p>Express 是一个自身功能极简，完全是由路由和中间件构成一个的 web 开发框架：从本质上来说，一个 Express 应用就是在调用各种中间件。</p>
<p><strong>中间件（Middleware）</strong> 是一个<strong>函数</strong>，它可以接收参数 请求对象（req)）, 响应对象（ res）, 和 web 应用中处于请求-响应循环流程中的中间件，一般被命名为 <code>next</code> 的变量。</p>
<p>中间件的功能包括：</p>
<ul>
<li>执行任何代码。</li>
<li>修改请求和响应对象。</li>
<li>终结请求-响应循环。</li>
<li>调用堆栈中的下一个中间件。</li>
</ul>
<p>如果当前中间件没有终结请求-响应循环，则必须调用 <code>next()</code> 方法将控制权交给下一个中间件，否则请求就会挂起。</p>
<h3 id="26-1-应用级中间件"><a href="#26-1-应用级中间件" class="headerlink" title="26.1 应用级中间件"></a>26.1 应用级中间件</h3><p>应用级中间件绑定在应用对象app上。中间件函数作为 app.use() 或者路由方法的回调函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 通过 app.use() 或者路由方法来绑定中间件</span><br><span class="line">2. 路由方法的回调函数本质上就是中间件</span><br></pre></td></tr></table></figure>

<h3 id="26-2-路由级中间件"><a href="#26-2-路由级中间件" class="headerlink" title="26.2 路由级中间件"></a>26.2 路由级中间件</h3><p>路由级中间件和应用级中间件一样，只是它绑定的对象为 <code>express.Router()</code>的返回值。</p>
<h3 id="26-3-错误处理中间件"><a href="#26-3-错误处理中间件" class="headerlink" title="26.3 错误处理中间件"></a>26.3 错误处理中间件</h3><blockquote>
<p>错误处理中间件有 <em>4</em> 个参数，定义错误处理中间件时必须使用这 4 个参数。即使不需要 <code>next</code> 对象，也必须在签名中声明它，否则中间件会被识别为一个常规中间件，不能处理</p>
</blockquote>
<p>错误处理中间件和其他中间件定义类似，只是要使用 4 个参数，而不是 3 个，其写法如下： <code>(err, req, res, next)</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span>(<span class="params">err, req, res, next</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err.<span class="property">stack</span>);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Something broke!&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="27-express-Router"><a href="#27-express-Router" class="headerlink" title="27 express.Router"></a>27 express.Router</h2><p>可使用 <code>express.Router</code> 类创建模块化、可挂载的路由句柄。<code>Router</code> 实例是一个完整的中间件和路由系统，因此常称其为一个 “mini-app”。</p>
<p>下面的实例程序创建了一个路由模块，并加载了一个中间件，定义了一些路由，并且将它们挂载至应用的路径上。</p>
<p>在 app 目录下创建名为 <code>birds.js</code> 的文件，内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该路由使用的中间件</span></span><br><span class="line">router.<span class="title function_">use</span>(<span class="keyword">function</span> <span class="title function_">timeLog</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Time: &#x27;</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 定义网站主页的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Birds home page&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 定义 about 页面的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/about&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;About birds&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p>然后在入口文件中加载路由模块：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> birds = <span class="built_in">require</span>(<span class="string">&#x27;./birds&#x27;</span>);</span><br><span class="line">...</span><br><span class="line">app.<span class="title function_">use</span>(birds);</span><br></pre></td></tr></table></figure>





<h2 id="28-模板引擎"><a href="#28-模板引擎" class="headerlink" title="28 模板引擎"></a>28 模板引擎</h2><h3 id="28-1-作用"><a href="#28-1-作用" class="headerlink" title="28.1 作用"></a>28.1 作用</h3><ul>
<li>渲染产生HTML</li>
<li>替换HTML中的数据内容</li>
<li>通过模板引擎的模板继承功能或模版包含功能实现页面的复用(如页头,页脚等)</li>
</ul>
<h3 id="28-2-常见的模板引擎"><a href="#28-2-常见的模板引擎" class="headerlink" title="28.2 常见的模板引擎"></a>28.2 常见的模板引擎</h3><ul>
<li>Ejs 模板引擎</li>
<li>Jade 模板引擎</li>
<li>swig 模板引擎</li>
<li>handlerbar 模板引擎</li>
</ul>
<h2 id="29-EJS-模板引擎"><a href="#29-EJS-模板引擎" class="headerlink" title="29 EJS 模板引擎"></a>29 EJS 模板引擎</h2><h3 id="29-1-基本使用"><a href="#29-1-基本使用" class="headerlink" title="29.1 基本使用"></a>29.1 基本使用</h3><h4 id="安装并导入"><a href="#安装并导入" class="headerlink" title="安装并导入"></a>安装并导入</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install ejs</span><br><span class="line">const ejs = require(<span class="string">&#x27;ejs&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="渲染出HTML"><a href="#渲染出HTML" class="headerlink" title="渲染出HTML"></a>渲染出HTML</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一种用法</span></span><br><span class="line"><span class="comment">// 渲染字符串</span></span><br><span class="line">ejs.<span class="title function_">render</span>(str, data, options);</span><br><span class="line"><span class="comment">// =&gt; 输出绘制后的 HTML 字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//第二种用法</span></span><br><span class="line"><span class="comment">// 渲染文件</span></span><br><span class="line">ejs.<span class="title function_">renderFile</span>(filename, data, options, <span class="keyword">function</span>(<span class="params">err, str</span>)&#123;</span><br><span class="line">    <span class="comment">// str =&gt; 输出绘制后的 HTML 字符串</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="29-2-模板语法"><a href="#29-2-模板语法" class="headerlink" title="29.2 模板语法"></a>29.2 模板语法</h3><h4 id="①-分隔符-定界符"><a href="#①-分隔符-定界符" class="headerlink" title="① 分隔符(定界符)"></a>① 分隔符(定界符)</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;% 语句 %&gt;		会执行，不会输出</span><br><span class="line">&lt;%= 表达式 %&gt;	   输出表达式的值，表达式的形式可以是变量、直接来、运算公式</span><br><span class="line">&lt;%- 表达式 %&gt;	   输出表达式的，不会进行转义</span><br><span class="line">&lt;%# 注释标签，不执行、不输出内容 %&gt;</span><br></pre></td></tr></table></figure>

<h4 id="②-模板内输出表达式的值"><a href="#②-模板内输出表达式的值" class="headerlink" title="② 模板内输出表达式的值"></a>② 模板内输出表达式的值</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= new Date() %&gt;</span><br><span class="line">&lt;%= 1 + 100 %&gt;</span><br><span class="line">&lt;%= nameList.join(&#x27;,&#x27;) %&gt;</span><br></pre></td></tr></table></figure>

<h4 id="③-模板内执行语句"><a href="#③-模板内执行语句" class="headerlink" title="③ 模板内执行语句"></a>③ 模板内执行语句</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;% users.forEach(function(user)&#123; %&gt;</span><br><span class="line">    &lt;%- include(&#x27;user/show&#x27;, &#123;user: user&#125;) %&gt;</span><br><span class="line">  &lt;% &#125;); %&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;% if (user) &#123; %&gt;</span><br><span class="line">  &lt;h2&gt;&lt;%= user.name %&gt;&lt;/h2&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<h4 id="④-include-语法"><a href="#④-include-语法" class="headerlink" title="④ include 语法"></a>④ include 语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;% users.forEach(function(user)&#123; %&gt;</span><br><span class="line">    &lt;%- include(&#x27;user/show&#x27;, &#123;user: user&#125;) %&gt;</span><br><span class="line">  &lt;% &#125;); %&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;%- include(&#x27;header&#x27;) -%&gt;</span><br><span class="line">&lt;h1&gt;</span><br><span class="line">  Title</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">  My page</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;%- include(&#x27;footer&#x27;) -%&gt;</span><br></pre></td></tr></table></figure>

<h4 id="⑤-自定义分隔符-定界符"><a href="#⑤-自定义分隔符-定界符" class="headerlink" title="⑤ 自定义分隔符(定界符)"></a>⑤ 自定义分隔符(定界符)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单个模板文件</span></span><br><span class="line">ejs.<span class="title function_">render</span>(<span class="string">&#x27;&lt;?= users.join(&quot; | &quot;); ?&gt;&#x27;</span>, &#123;<span class="attr">users</span>: users&#125;, &#123;<span class="attr">delimiter</span>: <span class="string">&#x27;?&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局</span></span><br><span class="line">ejs.<span class="property">delimiter</span> = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">ejs.<span class="title function_">render</span>(<span class="string">&#x27;&lt;$= users.join(&quot; | &quot;); $&gt;&#x27;</span>, &#123;<span class="attr">users</span>: users&#125;);</span><br></pre></td></tr></table></figure>



<h2 id="30-Express-中使用模板引擎"><a href="#30-Express-中使用模板引擎" class="headerlink" title="30 Express 中使用模板引擎"></a>30 Express 中使用模板引擎</h2><h3 id="30-1-模板引擎设置"><a href="#30-1-模板引擎设置" class="headerlink" title="30.1 模板引擎设置"></a>30.1 模板引擎设置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 设置 express 所使用的模板引擎 会根据这里的设置自动引入模板引擎，无须再写 require()</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. 设置模板文件的存放目录</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;pages&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="30-2-渲染"><a href="#30-2-渲染" class="headerlink" title="30.2 渲染"></a>30.2 渲染</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// 会在模板文件的存放目录中查找 index.ejs 文件</span></span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123; <span class="attr">title</span>: <span class="string">&#x27;Hey&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;Hello there!&#x27;</span>&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="30-3-修改模板文件扩展名"><a href="#30-3-修改模板文件扩展名" class="headerlink" title="30.3 修改模板文件扩展名"></a>30.3 修改模板文件扩展名</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//1. 更改模板引擎名字为 html</span></span><br><span class="line">app.<span class="title function_">engine</span>(<span class="string">&#x27;html&#x27;</span>, ejs.<span class="property">renderFile</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. 设置 express 所使用的模板引擎 </span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;html&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3. 设置模板文件的存放目录</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;pages&#x27;</span>));</span><br></pre></td></tr></table></figure>



<h2 id="31-会话控制介绍"><a href="#31-会话控制介绍" class="headerlink" title="31 会话控制介绍"></a>31 会话控制介绍</h2><p>HTTP 协议是一个无状态的协议，它无法区分多次请求是否发送自同一客户端。</p>
<p>而我们在实际的使用中，却又大量的这种需求，我们需要通过会话的控制来解决该问题。</p>
<p>常见的会话控制解决方案有 <strong>cookie</strong> 、<strong>session</strong> 等。</p>
<h2 id="32-cookie"><a href="#32-cookie" class="headerlink" title="32 cookie"></a>32 cookie</h2><h3 id="32-1-cookie-介绍"><a href="#32-1-cookie-介绍" class="headerlink" title="32.1 cookie 介绍"></a>32.1 cookie 介绍</h3><p>cookie本质是一个存储在浏览器的文本，随着http请求自动传递给服务器。</p>
<p>也可以说cookie是一个头（请求头&#x2F;响应头）：</p>
<ul>
<li>服务器以响应头的形式将如何设置 cookie 发送给浏览器。</li>
<li>浏览器收到以后会设置 cookie 并保存。</li>
<li>浏览器再次访问服务器时，会以请求头的形式将 cookie 发送。</li>
<li>服务器就可以通过检查浏览器发送的 cookie 来识别出不同的浏览器。</li>
</ul>
<h3 id="32-2-Node-中操作-cookie"><a href="#32-2-Node-中操作-cookie" class="headerlink" title="32.2 Node 中操作 cookie"></a>32.2 Node 中操作 cookie</h3><p>学习该小节，重在掌握 cookie 的原理； 实际操作中会有更简单的方式。</p>
<h4 id="读取-cookie"><a href="#读取-cookie" class="headerlink" title="读取 cookie"></a>读取 cookie</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cookie 信息会在请求头里，返回一个字符串。</span></span><br><span class="line">request.<span class="property">headers</span>.<span class="property">cookie</span>;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以使用第三方模块 cookie，来把 cookie 字符串处理成对象方便读取。</span></span><br><span class="line"><span class="keyword">const</span> cookie = <span class="built_in">require</span>(<span class="string">&#x27;cookie&#x27;</span>);</span><br><span class="line">cookie.<span class="title function_">parse</span>(request.<span class="property">headers</span>.<span class="property">cookie</span>);</span><br></pre></td></tr></table></figure>

<h4 id="设置-cookie-（添加或修改）"><a href="#设置-cookie-（添加或修改）" class="headerlink" title="设置 cookie （添加或修改）"></a>设置 cookie （添加或修改）</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过设置响应头来告知浏览器进行 cookie 的设置</span></span><br><span class="line"><span class="comment">// 设置 cookie</span></span><br><span class="line">response.<span class="title function_">setHeader</span>(<span class="string">&#x27;Set-Cookie&#x27;</span>, <span class="string">&#x27;username=anni&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同时设置多个 cookie</span></span><br><span class="line">response.<span class="title function_">setHeader</span>(<span class="string">&#x27;Set-cookie&#x27;</span>, [<span class="string">&#x27;age=100&#x27;</span>, <span class="string">&#x27;address=Shanghai&#x27;</span>, <span class="string">&#x27;grade=A&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置 cookie 的同时指定属性</span></span><br><span class="line">response.<span class="title function_">setHeader</span>(<span class="string">&#x27;Set-Cookie&#x27;</span>, <span class="string">&#x27;username=mingge;path=/a;max-age=3600&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同时设置多个 cookie 并指定属性</span></span><br><span class="line">response.<span class="title function_">setHeader</span>(</span><br><span class="line">    <span class="string">&#x27;Set-Cookie&#x27;</span>, </span><br><span class="line">    [</span><br><span class="line">        <span class="string">&#x27;username=tom; Max-Age=3600&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;addrress=Shanghai; Max-Age=7200; Path=/images; HttpOnly; Secure&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;grade=B; Max-Age=7200; Secure&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="删除-cookie"><a href="#删除-cookie" class="headerlink" title="删除 cookie"></a>删除 cookie</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除 cookie，通过把有效期设置为负值</span></span><br><span class="line">response.<span class="title function_">setHeader</span>(<span class="string">&#x27;Set-Cookie&#x27;</span>, <span class="string">&#x27;grade=; Max-Age=-1&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="cookie-操作总结（重要）"><a href="#cookie-操作总结（重要）" class="headerlink" title="cookie 操作总结（重要）"></a>cookie 操作总结（重要）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 即使 key（名字） 相同，path 不同或者 domain 就是不同的 cookie</span><br><span class="line">2. 不论是设置 cookie 还是读取 cookie，要求 domain 和 path 要对应，如果不对应不能设置或读取</span><br><span class="line">3. path 默认值是 / 表示对整个网站下的路径都可以对应； domain 默认值是当前的主机名。</span><br><span class="line">4. Max-Age 选项表示cookie的生存时间，可以指定数字表示多少毫秒， 如果不设置浏览器关闭cookie就消失； 如果想要删除某个cookie，可以重新设置该cookie，将 max-age 设置为 -1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 设置cookie（添加和修改）</span><br><span class="line">   设置响应头 Set—Cookie，浏览器接收到响应头之后会根据要求设置 cookie</span><br><span class="line">   </span><br><span class="line">2. 读取cookie</span><br><span class="line">   浏览器向服务端发送请求的时候，会将该网站的cookie放在请求头里</span><br><span class="line">   服务器通过请求对象，获取请求里面的 cookie，请求头的名字就叫 cookie</span><br><span class="line">   </span><br><span class="line">3. 删除cookie</span><br><span class="line">   重新设置该cookie，将它的 max-age 设置为 -1</span><br></pre></td></tr></table></figure>

<h3 id="32-3-express-中使用中间件处理-cookie"><a href="#32-3-express-中使用中间件处理-cookie" class="headerlink" title="32.3 express 中使用中间件处理 cookie"></a>32.3 express 中使用中间件处理 cookie</h3><p>在 express 中，通过配置 <code>cookie-parser</code> 中间件，可以将 <code>cookie</code> 解析为一个对象，并为 <code>request</code> 对象添加了一些操作 cookie 属性方法。</p>
<p><strong>安装：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cookie-parser</span><br></pre></td></tr></table></figure>

<p><strong>引入：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&quot;cookie-parser&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>挂载中间件：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>());</span><br></pre></td></tr></table></figure>

<p><strong>使用：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置 cookie （添加或修改） 注意：cookie的属性设置使用小驼峰</span></span><br><span class="line">res.<span class="title function_">cookie</span>(<span class="string">&quot;userName&quot;</span>,<span class="string">&quot;laoli&quot;</span>,&#123;<span class="attr">path</span>: <span class="string">&#x27;/getCookie&#x27;</span>&#125;);</span><br><span class="line">res.<span class="title function_">cookie</span>(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>,&#123;<span class="attr">maxAge</span>:<span class="number">20</span>*<span class="number">1000</span>,<span class="attr">domain</span>:<span class="string">&quot;learn.fuming.site&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取cookie   返回对象</span></span><br><span class="line">req.<span class="property">cookies</span>;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除 cookie</span></span><br><span class="line">res.<span class="title function_">clearCookie</span>(<span class="string">&quot;userName&quot;</span>);	<span class="comment">// 注意：默认只删除 path 是 / 的cookie</span></span><br><span class="line">res.<span class="title function_">clearCookie</span>(<span class="string">&quot;age&quot;</span>,&#123;<span class="attr">path</span>:<span class="string">&quot;/login&quot;</span>&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="32-4-cookie-的属性详解"><a href="#32-4-cookie-的属性详解" class="headerlink" title="32.4 cookie 的属性详解"></a>32.4 cookie 的属性详解</h3><p><strong>Domain</strong>：可以访问该 cookie 的域名。例如，如果设置为 <code>.fuming.site</code>，则所有以 <code>fuming.site</code> 结尾的域名都可以访问该 cookie。</p>
<p><strong>Expries：</strong> cookie 的最长有效时间。</p>
<p><strong>Max-Age</strong>：设置 cookie失效的时间，单位为秒，用来代替原来 Expires，通过它可以计算出其有效时间。maxAge 如果为正数，则该cookie在 maxAge 秒之后失效。如果为负数，则关闭浏览器时 cookie 即失效，浏览器也不会以任何形式保存该 cookie。</p>
<p><strong>Path</strong>：该 cookie 的使用路径。如果设置为 <code>/path/</code>，则只有路径为 ·&#x2F;path&#x2F;· 的页面可以访问该 cookie；如果设置为 <code>/</code>，则本域名下的所有页面都可以访问该 cookie。</p>
<p><strong>HttpOnly</strong>：若此属性为true，则只有在 HTTP 头中会带有此 cookie 的信息，而不能通过 <code>document.cookie</code> 来访问此 cookie。</p>
<p><strong>Secure</strong>：该cookie是否仅被使用安全协议传输。安全协议有 HTTPS 和 SSL 等，在网络上传输数据之前先将数据加密。默认为 false。</p>
<h3 id="32-5-cookie-的不足"><a href="#32-5-cookie-的不足" class="headerlink" title="32.5 cookie 的不足"></a>32.5 cookie 的不足</h3><p>1）各个浏览器对 cookie 的数量和大小都有不同的限制，这样就导致我们不能在 cookie 中保存过多的信息。一般数量不超过 50 个，单个大小不超过 4kb。</p>
<p>2）cookie 的内容是由服务器发送给浏览器，再由浏览器将 cookie 发回，如果 cookie 较大会导致发送速度非常慢，降低用户的体验。</p>
<h2 id="33-session"><a href="#33-session" class="headerlink" title="33 session"></a>33 session</h2><h3 id="33-1-session-介绍"><a href="#33-1-session-介绍" class="headerlink" title="33.1 session 介绍"></a>33.1 session 介绍</h3><p>Session 是一个对象，存储特定用户会话所需的属性及配置信息。Session是保存在服务器端的数据，保存介质可以是文件、数据库或者内存。</p>
<p><strong>session 运行原理：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 服务器中为每一次会话创建一个对象，然后每个对象都设置一个唯一的 ID。</span><br><span class="line">2. 通过设置响应头让浏览器设置 cookie 用于保存该 ID。</span><br><span class="line">3. 将会话中产生的数据统一保存到 session 对象中，这样我们就可以将用户的数据全都保存到服务器中，而不需要保存到客户端，客户端只需要保存一个 ID 即可。</span><br></pre></td></tr></table></figure>

<h3 id="33-2-在-Node-中使用-session"><a href="#33-2-在-Node-中使用-session" class="headerlink" title="33.2 在 Node 中使用 session"></a>33.2 在 Node 中使用 session</h3><p>**设置 session： **</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建唯一 ID</span></span><br><span class="line"><span class="keyword">const</span> sessId = uuid.<span class="title function_">v4</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 session 数据写入文件</span></span><br><span class="line">fs.<span class="title function_">writeFileSync</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;sess&#x27;</span>, sessId), <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置cookie</span></span><br><span class="line">res.<span class="title function_">set</span>(<span class="string">&#x27;Set-Cookie&#x27;</span>, <span class="string">&#x27;sessid=&#x27;</span>+sessId);</span><br></pre></td></tr></table></figure>

<p><strong>读取 session ：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 读取 cookie 中的 session ID</span></span><br><span class="line"><span class="keyword">const</span> sessId = cookie.<span class="title function_">parse</span>(req.<span class="property">headers</span>.<span class="property">cookie</span>).<span class="property">sessid</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 读取文件中的 session 数据并解析为对象</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(fs.<span class="title function_">readFileSync</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;sess&#x27;</span>, sessId)));</span><br></pre></td></tr></table></figure>

<p><strong>销毁 session：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 读取 cookie 中的 session ID</span></span><br><span class="line"><span class="keyword">const</span> sessId = cookie.<span class="title function_">parse</span>(req.<span class="property">headers</span>.<span class="property">cookie</span>).<span class="property">sessid</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 删除文件</span></span><br><span class="line">fs.<span class="title function_">unlinkSync</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;sess&#x27;</span>, sessId));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 设置 cookie 失效</span></span><br><span class="line">res.<span class="title function_">set</span>(<span class="string">&#x27;Set-Cookie&#x27;</span>, <span class="string">&#x27;sessid=&#x27;</span>+sessId+<span class="string">&#x27;;Max-Age=-1&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="33-3-express-中-使用中间件处理-session"><a href="#33-3-express-中-使用中间件处理-session" class="headerlink" title="33.3 express 中 使用中间件处理 session"></a>33.3 express 中 使用中间件处理 session</h3><p>在 express 中，通过配置 <code>express-session</code> 中间件，可以将 <code>cookie</code> 解析为一个对象，并为 <code>request</code> 对象添加了一些操作 cookie 属性方法。</p>
<p><strong>安装：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express-session</span><br></pre></td></tr></table></figure>

<p><strong>引入：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>挂载中间件：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;sess&#x27;</span>,      <span class="comment">// 设置cookie的name，默认值是：connect.sid</span></span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&#x27;atguigu&#x27;</span>, <span class="comment">// 参与加密的字符串（又称签名）</span></span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">false</span>, <span class="comment">//是否为每次请求都设置一个 cookie 用来存储 session 的 id</span></span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span> ,<span class="comment">// 强制保存 session 即使它并没有变化, 默认为 true,建议设置成 false。</span></span><br><span class="line">    <span class="attr">cookie</span>: &#123;</span><br><span class="line">           <span class="attr">httpOnly</span>: <span class="literal">true</span>, <span class="comment">// 开启后前端无法通过 JS 操作</span></span><br><span class="line">           <span class="attr">maxAge</span>: <span class="number">1000</span>*<span class="number">30</span> <span class="comment">// 这一条 是控制 sessionID 的过期时间的！！！</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<p><strong>使用：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/setSession&quot;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>)&#123;</span><br><span class="line">    req.<span class="property">session</span>.<span class="property">userName</span> = <span class="string">&quot;zhangsan&quot;</span>;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;设置成功&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/getSession&quot;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">session</span>.<span class="property">userName</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;获取成功&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/delSession&quot;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>)&#123;</span><br><span class="line">    req.<span class="property">session</span>.<span class="title function_">destroy</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">       res.<span class="title function_">send</span>(<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="33-4-cookie-和-session-的区别"><a href="#33-4-cookie-和-session-的区别" class="headerlink" title="33.4 cookie 和 session 的区别"></a>33.4 cookie 和 session 的区别</h3><p><strong>1）存储位置：</strong></p>
<ul>
<li>cookie 存在于客户端。</li>
<li>session 存在于服务器端，一个 session 对象为一个用户浏览器服务。</li>
</ul>
<p><strong>2）安全性：</strong></p>
<ul>
<li>cookie 是以明文的方式存放在客户端的，安全性较低，可以通过一个加密算法进行加密后存放。</li>
<li>session存放于服务器中，所以安全性较好。</li>
</ul>
<p><strong>3） 网络传输量：</strong></p>
<ul>
<li>cookie 会传递消息给服务器。</li>
<li>session 本身存放于服务器，但是通过 cookie 传递 id，会有少量的传送流量。</li>
</ul>
<p><strong>4）大小：</strong></p>
<ul>
<li>cookie 保存的数据不能超过4K，很多浏览器都限制一个站点最多保存50个cookie。</li>
<li>session 保存数据理论上没有任何限制。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/04/Node/" data-id="cl4007ohw0001q4dxhp785xe1" data-title="Node" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/" rel="tag">Node</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Git" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/04/Git/" class="article-date">
  <time class="dt-published" datetime="2022-06-04T14:40:37.000Z" itemprop="datePublished">2022-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/06/04/Git/">Git</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="1-Git-介绍"><a href="#1-Git-介绍" class="headerlink" title="1 Git 介绍"></a>1 Git 介绍</h2><p>Git 是一款开源免费的分布式的<strong>版本控制系统</strong>。是 Linux 之父 Linus Torvalds（林纳斯·托瓦兹）为了方便管理 linux 代码代码而开发的。</p>
<p>Git 可以实现的功能：</p>
<ul>
<li>代码备份</li>
<li>版本回退</li>
<li>多人协作</li>
<li>权限控制</li>
</ul>
<p>Git 工具下载地址：<a target="_blank" rel="noopener" href="https://git-scm.com/">https://git-scm.com/</a></p>
<p>GIt 官方文档地址：<a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2">https://git-scm.com/book/zh/v2</a></p>
<h2 id="2-Git-准备工作"><a href="#2-Git-准备工作" class="headerlink" title="2 Git 准备工作"></a>2 Git 准备工作</h2><h3 id="2-1-常用-Linux-操作"><a href="#2-1-常用-Linux-操作" class="headerlink" title="2.1 常用 Linux 操作"></a>2.1 常用 Linux 操作</h3><h4 id="①-常用-Linux-命令"><a href="#①-常用-Linux-命令" class="headerlink" title="① 常用 Linux 命令"></a>① 常用 Linux 命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ls 		将当前目录下所有的文件或子目录列举	选项 a:包括隐藏文件， l:详细信息</span><br><span class="line">		ls</span><br><span class="line">		ls -a</span><br><span class="line">		ls -l</span><br><span class="line">		ls -al</span><br><span class="line"></span><br><span class="line">cd 		进入到指定的目录</span><br><span class="line">		cd  目录的路径（相对路径绝对路径）</span><br><span class="line">		cd ..	进入上一级目录</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rm 		删除指定的文件或目录</span><br><span class="line">		rm -rf 目录名或文件名</span><br><span class="line">		</span><br><span class="line">clear 	清除当前命令行</span><br></pre></td></tr></table></figure>

<h4 id="②-常用快捷键"><a href="#②-常用快捷键" class="headerlink" title="② 常用快捷键"></a>② 常用快捷键</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tab				自动补全路径</span><br><span class="line">ctrl + L		清除当前命令行</span><br><span class="line">ctrl + C		终止当前命令</span><br><span class="line">键盘上下方向键	    调取历史命令</span><br></pre></td></tr></table></figure>

<h3 id="2-2-Vim-的使用"><a href="#2-2-Vim-的使用" class="headerlink" title="2.2 Vim 的使用"></a>2.2 Vim 的使用</h3><p>vim 是一个代码编辑软件，可以对文件进行创建、编辑。</p>
<p>使用 vim 命令打开文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim 文件名</span><br></pre></td></tr></table></figure>

<p>如果要打开的文件是不存在，会自动创建文件。</p>
<p><img src="D:/1-尚硅谷课件/SH220310/文档/images/vim工作模式.png" alt="三种模式"></p>
<h4 id="①-命令模式"><a href="#①-命令模式" class="headerlink" title="① 命令模式"></a>① 命令模式</h4><p>使用 vim 打开文件之后，最先进入的就是命令模式，命令模式下无法编辑文件的，只能输入命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i	<span class="comment"># 进入输入模式</span></span><br></pre></td></tr></table></figure>

<h4 id="②-输入模式"><a href="#②-输入模式" class="headerlink" title="② 输入模式"></a>② 输入模式</h4><p>只有在输入模式下才能对文件进行编辑。</p>
<p>在命令模式下输入 i 命令即可进入输入模式。</p>
<p>在输入模式下按 <code>ESC</code> 键可以再次回到命令模式。</p>
<h4 id="③-底线命令模式"><a href="#③-底线命令模式" class="headerlink" title="③ 底线命令模式"></a>③ 底线命令模式</h4><p>在模式下按 : 可以进入底线命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:w		<span class="comment"># 保存并退出底线命令， :w! 表示强制保存。</span></span><br><span class="line">:q		<span class="comment"># 退出 vim          :q! 表示强制退出</span></span><br><span class="line">:wq     <span class="comment"># 保存并退出 vim，  :wq! 表示强制保存并退出</span></span><br></pre></td></tr></table></figure>



<h2 id="3-Git-基础概念"><a href="#3-Git-基础概念" class="headerlink" title="3 Git 基础概念"></a>3 Git 基础概念</h2><h3 id="3-1-git-目录-仓库目录"><a href="#3-1-git-目录-仓库目录" class="headerlink" title="3.1 .git 目录 仓库目录"></a>3.1 <code>.git</code> 目录 仓库目录</h3><ul>
<li>hooks 目录包含客户端或服务端的钩子脚本，在特定操作下自动执行。</li>
<li>info 包含一个全局性排除文件，可以配置文件忽略。</li>
<li>logs 保存日志信息。</li>
<li>objects 目录存储所有数据内容,本地的版本库存放位置。</li>
<li>refs 目录存储指向数据的提交对象的指针（分支）。</li>
<li>config 文件包含项目特有的配置选项。</li>
<li>description 用来显示对仓库的描述信息。</li>
<li>HEAD 文件指示目前被检出的分支。</li>
<li>index 暂存区数据。</li>
</ul>
<blockquote>
<p><strong>切记：</strong> 不要手动去修改 .git 文件夹中的内容。</p>
</blockquote>
<h3 id="3-2-Git-仓库的三个区域"><a href="#3-2-Git-仓库的三个区域" class="headerlink" title="3.2 Git 仓库的三个区域"></a>3.2 Git 仓库的三个区域</h3><p><strong>工作区：</strong> 代码编辑区，编辑代码的地方。</p>
<p><strong>暂存区：</strong> 修改待提交区。</p>
<p><strong>版本库：</strong> 真正存储代码的地方。</p>
<h2 id="4-Git-基础命令总结"><a href="#4-Git-基础命令总结" class="headerlink" title="4 Git 基础命令总结"></a>4 Git 基础命令总结</h2><h3 id="4-1-初始化配置"><a href="#4-1-初始化配置" class="headerlink" title="4.1 初始化配置"></a>4.1 初始化配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --global 表示对所有用户都生效</span></span><br><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;email@example.com&quot;</span></span><br></pre></td></tr></table></figure>

<p>初始化配置只在git安装之后进行一次即可！</p>
<h3 id="4-2-仓库初始化"><a href="#4-2-仓库初始化" class="headerlink" title="4.2 仓库初始化"></a>4.2 仓库初始化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>

<p>每次创建新的项目，都要进行仓库初始化；每个新项目初始化一次就可以了。</p>
<h3 id="4-3-添加暂存区"><a href="#4-3-添加暂存区" class="headerlink" title="4.3 添加暂存区"></a>4.3 添加暂存区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git add &lt;file&gt;    <span class="comment"># 添加指定文件到暂存区</span></span><br><span class="line">git add -u        <span class="comment"># 添加所有被删除或被修改的文件到暂存区（不包括新增文件）</span></span><br><span class="line">git add .         <span class="comment"># 添加所有修改和新建的文件到暂存区（不包括删除的文件）</span></span><br><span class="line">git add -A        <span class="comment"># 添加所有被删除、被替换、被修改和新增的文件到暂存区，推荐使用！</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4-提交版本库"><a href="#4-4-提交版本库" class="headerlink" title="4.4 提交版本库"></a>4.4 提交版本库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&quot;提交日志&quot;</span>         <span class="comment"># 把暂存区的东西提交到版本库</span></span><br><span class="line">git commit -am <span class="string">&quot;提交日志&quot;</span>        <span class="comment"># 把工作区的修改一步到位添加暂存并提交到版本库</span></span><br></pre></td></tr></table></figure>

<h3 id="4-5-查看状态和变化"><a href="#4-5-查看状态和变化" class="headerlink" title="4.5  查看状态和变化"></a>4.5  查看状态和变化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status;</span><br></pre></td></tr></table></figure>

<p>该命令会对工作区和版本库进行比较； 也会对暂存区与版本库进行比较。</p>
<p><img src="C:\Users\杨小龙\AppData\Roaming\Typora\typora-user-images\image-20220520192025540.png" alt="image-20220520192025540"></p>
<p>如果 <code>git status</code> 命令的输出对于你来说过于简略，而你想知道具体修改了什么地方，可以用 <code>git diff</code> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git diff             <span class="comment"># 查看当前工作区和版本库的差异 （不包括新增的文件）</span></span><br><span class="line">git diff --cached    <span class="comment"># 查看暂存区中的变化</span></span><br></pre></td></tr></table></figure>

<h3 id="4-6-撤销修改和撤销暂存"><a href="#4-6-撤销修改和撤销暂存" class="headerlink" title="4.6 撤销修改和撤销暂存"></a>4.6 撤销修改和撤销暂存</h3><h4 id="①-工作区的修改没有添加暂存"><a href="#①-工作区的修改没有添加暂存" class="headerlink" title="① 工作区的修改没有添加暂存"></a>① 工作区的修改没有添加暂存</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git restore &lt;文件名&gt;    <span class="comment"># 恢复工作区指定文件</span></span><br><span class="line">git restore .          <span class="comment"># 恢复工作区所有的修改（恢复之后，新增的文件不会被删除）</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>会使用版本库当前最前的版本进行恢复！</p>
</blockquote>
<p><strong>注意：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout -- &lt;file&gt; <span class="comment"># 同 git restore &lt;file&gt; 作用一致</span></span><br><span class="line">git checkout -- .      <span class="comment"># 同 git restore . 作用一致</span></span><br></pre></td></tr></table></figure>

<h4 id="②-工作区的修改已经添加到暂存"><a href="#②-工作区的修改已经添加到暂存" class="headerlink" title="② 工作区的修改已经添加到暂存"></a>② 工作区的修改已经添加到暂存</h4><p>如果工作区的修改已经添加到暂存区，先清除暂存区，再恢复工作区。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git restore --staged &lt;文件名&gt;        <span class="comment"># 把指定文件从暂存区移除</span></span><br><span class="line">git restore --staged .              <span class="comment"># 把所有文件从暂存区移除</span></span><br></pre></td></tr></table></figure>

<h3 id="4-7-历史版本回滚"><a href="#4-7-历史版本回滚" class="headerlink" title="4.7 历史版本回滚"></a>4.7 历史版本回滚</h3><h4 id="4-7-1-查看历史版本号"><a href="#4-7-1-查看历史版本号" class="headerlink" title="4.7.1 查看历史版本号"></a>4.7.1 查看历史版本号</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span>		<span class="comment"># 查看提交记录</span></span><br><span class="line">git <span class="built_in">log</span> -n	<span class="comment"># 查看最近的 n 次提交几次，n 是个数字</span></span><br><span class="line">git <span class="built_in">log</span> --oneline	<span class="comment"># 每次提交记录只用一行显示</span></span><br></pre></td></tr></table></figure>

<p>如果需要查看被回滚掉的提交的版本号：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reflog</span><br></pre></td></tr></table></figure>

<h4 id="4-7-2-通过指定版本号回滚"><a href="#4-7-2-通过指定版本号回滚" class="headerlink" title="4.7.2 通过指定版本号回滚"></a>4.7.2 通过指定版本号回滚</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard &lt;commitID&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意：</strong></p>
<p>进行版本回退时，不需要使用完整的哈希字符串(版本号，CommitID)，前七位即可。</p>
<p>版本切换之前，要提交当前的代码状态到仓库。</p>
</blockquote>
<h4 id="4-7-3-快捷回滚"><a href="#4-7-3-快捷回滚" class="headerlink" title="4.7.3 快捷回滚"></a>4.7.3 快捷回滚</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD^    <span class="comment"># 恢复到上个版本</span></span><br><span class="line">git reset --hard HEAD^^    <span class="comment"># 恢复到上上个版本</span></span><br><span class="line">git reset --hard HEAD^^^    <span class="comment"># 恢复到上上上个版本</span></span><br></pre></td></tr></table></figure>



<h2 id="5-Git-忽略文件"><a href="#5-Git-忽略文件" class="headerlink" title="5 Git 忽略文件"></a>5 Git 忽略文件</h2><h3 id="5-1-被忽略的文件"><a href="#5-1-被忽略的文件" class="headerlink" title="5.1 被忽略的文件"></a>5.1 被忽略的文件</h3><p>哪些文件需要被 git 忽略：</p>
<ol>
<li>忽略操作系统自动生成的文件，比如缩略图等；</li>
<li>忽略编译生成的中间文件、可执行文件等，也就是如果一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如 Java 编译产生的<code>.class</code>文件；</li>
<li>忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件。</li>
</ol>
<h3 id="5-2-设置忽略文件-gitignore"><a href="#5-2-设置忽略文件-gitignore" class="headerlink" title="5.2 设置忽略文件 .gitignore"></a>5.2 设置忽略文件 <code>.gitignore</code></h3><p>忽略文件的文件名是 <code>.gitignore</code> 的文件, 文件内可以设置项目的忽略规则。</p>
<p>忽略文件可以放在项目中的任意目录中，放在哪个目录作用范围就是哪个目录； 一般忽略文件会放在项目的根目录下。</p>
<h3 id="5-3-忽略文件的语法"><a href="#5-3-忽略文件的语法" class="headerlink" title="5.3 忽略文件的语法"></a>5.3 忽略文件的语法</h3><p>可以用<code>git check-ignore</code> 命令检查 <code>.gitignore</code>文件格式是否正确。</p>
<p><code>.gitignore</code> 文件的格式规则如下：</p>
<ol>
<li>空格不匹配任意文件，可作为分隔符，可用反斜杠转义。</li>
<li><code>#</code> 开头的文件表示注释，可以使用反斜杠进行转义。</li>
<li><code>!</code> 开头的模式表示否定，该文件将会再次被包含，如果排除了该文件的父级目录，则使用 <code>!</code> 也不会再次被包含。可以使用反斜杠进行转义。</li>
<li><code>/</code> 结束的模式只匹配目录以及在该目录路径下的内容。</li>
<li><code>/</code> 开始的模式匹配当前目录下的，（<code>.gitignore</code> 文件所在的目录）</li>
<li><code>**</code> 匹配多级目录，可在开始，中间，结束。</li>
<li><code>*</code> 匹配任意数量的任意字符串。</li>
<li><code>?</code> 通用匹配单个字符。</li>
<li><code>[]</code> 通用匹配单个字符列表。</li>
</ol>
<h3 id="5-4-忽略文件配置示例"><a href="#5-4-忽略文件配置示例" class="headerlink" title="5.4 忽略文件配置示例"></a>5.4 忽略文件配置示例</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 此为注释 </span><br><span class="line"># 忽略所有的 .a 文件</span><br><span class="line">*.a</span><br><span class="line"></span><br><span class="line"># 但跟踪所有的 lib.a，即便你在前面忽略了 .a 文件</span><br><span class="line">!lib.a</span><br><span class="line"></span><br><span class="line"># 只忽略当前目录下的 TODO 文件，而不忽略子目录下的 TODO 文件</span><br><span class="line">/TODO</span><br><span class="line"></span><br><span class="line"># 忽略任何目录下名为 build 的文件夹</span><br><span class="line">build/</span><br><span class="line"></span><br><span class="line"># 忽略 doc/notes.txt，但不忽略 doc/server/arch.txt</span><br><span class="line">doc/*.txt</span><br><span class="line"></span><br><span class="line"># 忽略 doc/ 目录及其所有子目录下的 .pdf 文件</span><br><span class="line">doc/**/*.pdf</span><br></pre></td></tr></table></figure>





<h2 id="6-Git-分支"><a href="#6-Git-分支" class="headerlink" title="6 Git 分支"></a>6 Git 分支</h2><h3 id="6-1-分支介绍"><a href="#6-1-分支介绍" class="headerlink" title="6.1 分支介绍"></a>6.1 分支介绍</h3><p>分支并非 Git 的专利，几乎所有的版本控制系统都以某种形式支持分支。</p>
<p>使用分支意味着你可以把你的工作从开发主线上分离开来，以免影响开发主线。</p>
<p><img src="D:/1-尚硅谷课件/SH220310/第三阶段/day13_Git/images/分支.jpg" alt="分支"></p>
<h3 id="6-2-分支操作"><a href="#6-2-分支操作" class="headerlink" title="6.2 分支操作"></a>6.2 分支操作</h3><blockquote>
<p><strong>注意：</strong> 在进行分支操作之前，一定一定要把工作区都提交了！！！</p>
</blockquote>
<h4 id="①-创建分支"><a href="#①-创建分支" class="headerlink" title="① 创建分支"></a>① 创建分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch 分支名</span><br></pre></td></tr></table></figure>

<p>会根据当前所在的分支进行创建。</p>
<h4 id="②-切换分支"><a href="#②-切换分支" class="headerlink" title="② 切换分支"></a>② 切换分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git switch 分支名</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">git checkout 分支名</span><br></pre></td></tr></table></figure>

<h4 id="③-创建并切换到该分支"><a href="#③-创建并切换到该分支" class="headerlink" title="③ 创建并切换到该分支"></a>③ 创建并切换到该分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git switch -c 分支名</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">git checkout -b 分支名</span><br></pre></td></tr></table></figure>

<h4 id="④-查看分支"><a href="#④-查看分支" class="headerlink" title="④ 查看分支"></a>④ 查看分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure>

<h4 id="⑤-删除分支"><a href="#⑤-删除分支" class="headerlink" title="⑤ 删除分支"></a>⑤ 删除分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d 分支名</span><br></pre></td></tr></table></figure>

<h4 id="⑥-合并分支"><a href="#⑥-合并分支" class="headerlink" title="⑥ 合并分支"></a>⑥ 合并分支</h4><p>如果把 A 分支合并到 B 分支上，先切换到 B 分支上。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge 分支名		<span class="comment"># 把指定的分支合并到当前分支</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-合并分支解决冲突"><a href="#6-3-合并分支解决冲突" class="headerlink" title="6.3 合并分支解决冲突"></a>6.3 合并分支解决冲突</h3><p>当多个分支修改同一个文件后，合并分支的时候就会产生冲突。冲突的解决非常简单，将内容修改为最终想要的结果，然后继续执行 <code>git add</code> 与 <code>git commit</code> 就可以了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 从主分支上创建开发分支</span><br><span class="line">2. 从开发分支分别创建 order 分支和 shopcart 分支</span><br><span class="line">3. 在 order 分支上做两次提交</span><br><span class="line">4. 在 shopcart 分支上做三体提交</span><br><span class="line">5. 将 order 分支与 shopcart 分支都合并到 dev 上</span><br><span class="line">6. 将 dev 分支合并到 主分支</span><br></pre></td></tr></table></figure>



<h3 id="6-4-远程仓库和分支"><a href="#6-4-远程仓库和分支" class="headerlink" title="6.4 远程仓库和分支"></a>6.4 远程仓库和分支</h3><h4 id="6-4-1-克隆特定分支"><a href="#6-4-1-克隆特定分支" class="headerlink" title="6.4.1 克隆特定分支"></a>6.4.1 克隆特定分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b 分支名 仓库地址</span><br></pre></td></tr></table></figure>

<h4 id="6-4-2-克隆所有分支，再切换到指定分支"><a href="#6-4-2-克隆所有分支，再切换到指定分支" class="headerlink" title="6.4.2 克隆所有分支，再切换到指定分支"></a>6.4.2 克隆所有分支，再切换到指定分支</h4><p>克隆所有的分支</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> 仓库地址</span><br></pre></td></tr></table></figure>

<p>克隆之后，默认只有主分支，可以通过以下方式切换到其他分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch  分支名 origin/远程分支名</span><br></pre></td></tr></table></figure>

<h4 id="6-4-3-将其他分支拉取并合并到本分支"><a href="#6-4-3-将其他分支拉取并合并到本分支" class="headerlink" title="6.4.3 将其他分支拉取并合并到本分支"></a>6.4.3 将其他分支拉取并合并到本分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin 分支名</span><br></pre></td></tr></table></figure>

<h4 id="6-4-4-推送其他分支"><a href="#6-4-4-推送其他分支" class="headerlink" title="6.4.4 推送其他分支"></a>6.4.4 推送其他分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin 本地分支名:远程分支名</span><br></pre></td></tr></table></figure>



<h2 id="7-GitHub-Git-远程仓库"><a href="#7-GitHub-Git-远程仓库" class="headerlink" title="7 GitHub - Git 远程仓库"></a>7 GitHub - Git 远程仓库</h2><h3 id="7-1-GitHub-介绍"><a href="#7-1-GitHub-介绍" class="headerlink" title="7.1 GitHub 介绍"></a>7.1 GitHub 介绍</h3><p>Hub 是一个代码仓库的托管平台，因为只支持 Git 作为唯一的版本库格式进行托管，故名 GitHub。可以创建远程中心仓库，为多人合作开发提供便利。</p>
<p>目前，其注册用户已经超过 350 万，托管版本数量也是非常之多，其中不乏知名开源项目 Ruby on Rails、jQuery、python等。</p>
<p>2018 年 6 月 4 日，微软宣布，通过 75 亿美元的股票交易收购代码托管平台 GitHub。</p>
<p>网址：<a target="_blank" rel="noopener" href="https://github.com/">https://github.com</a></p>
<p>从搜索框，输入，可以查看星数十万以上，会从高到低排列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stars:&gt;100000</span><br></pre></td></tr></table></figure>



<h3 id="7-2-GitHub-使用流程"><a href="#7-2-GitHub-使用流程" class="headerlink" title="7.2 GitHub 使用流程"></a>7.2 GitHub 使用流程</h3><h4 id="①-场景一：-本地有仓库-远程没有仓库"><a href="#①-场景一：-本地有仓库-远程没有仓库" class="headerlink" title="① 场景一： 本地有仓库 远程没有仓库"></a>① 场景一： 本地有仓库 远程没有仓库</h4><ol>
<li><p>在 github 上创建一个仓库</p>
</li>
<li><p>获取到远程仓库的地址</p>
</li>
<li><p>本地运行命令， 给仓库地址取别名为 origin</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin 远程仓库地址</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 仓库地址别名的其他操作</span></span><br><span class="line">git remote remove 名字;			<span class="comment"># 删除</span></span><br><span class="line">git remote rename 名字 新名字;     <span class="comment"># 改名</span></span><br><span class="line">git remove get-url 名字；		   <span class="comment"># 查看名字对应的仓库地址</span></span><br><span class="line">git remove set-url 名字 地址;	   <span class="comment"># 修改名字对应的仓库地址</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>本地仓库提交</p>
</li>
<li><p>把本地仓库推送到远程仓库 （第一次）, <code>-u</code> 的意思是记录远程仓库的地址。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>
</li>
<li><p>以后如果向远程仓库推送</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push master</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="②-场景二：-本地没仓库-远程有仓库"><a href="#②-场景二：-本地没仓库-远程有仓库" class="headerlink" title="② 场景二： 本地没仓库 远程有仓库"></a>② 场景二： 本地没仓库 远程有仓库</h4><ol>
<li><p>获取到远程仓库的地址</p>
</li>
<li><p>本地克隆远程仓库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> 远程仓库地址</span><br></pre></td></tr></table></figure>
</li>
<li><p>本地仓库如有修改，一定要添加并提交</p>
</li>
<li><p>将本地仓库推送到远程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin 本地分支名:远程分支名</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="③-从远程仓库克隆之后，创建本地分支"><a href="#③-从远程仓库克隆之后，创建本地分支" class="headerlink" title="③ 从远程仓库克隆之后，创建本地分支"></a>③ 从远程仓库克隆之后，创建本地分支</h4><p>默认从远程仓库克隆的只有主分支，如果我们需要在其他分支进行开发，只要在本地创建分支即可。</p>
<p><strong>查看所有分支：包括远程的分支</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -a</span><br></pre></td></tr></table></figure>

<p><strong>本地创建分支并设置对应的远程分支：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git switch -c 分支名 origin/远程分支名</span><br></pre></td></tr></table></figure>





<h3 id="7-3-多人合作"><a href="#7-3-多人合作" class="headerlink" title="7.3 多人合作"></a>7.3 多人合作</h3><h4 id="①-创建组织配置权限"><a href="#①-创建组织配置权限" class="headerlink" title="① 创建组织配置权限"></a>① 创建组织配置权限</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">首页 -&gt; 右上角 `+` 号 -&gt; new Organization</span><br><span class="line">免费计划</span><br><span class="line">填写组织名称和联系方式（不用使用中文名称）</span><br><span class="line">邀请其他开发者进入组织（会有邮件邀请，==如收不到，请查看垃圾箱==）</span><br><span class="line">配置组织权限，组织首页右侧  settings -&gt; Member privileges -&gt; 选择 write</span><br></pre></td></tr></table></figure>

<h4 id="②-多人合作工作流程"><a href="#②-多人合作工作流程" class="headerlink" title="② 多人合作工作流程"></a>② 多人合作工作流程</h4><p><strong>第一天上班：</strong></p>
<ol>
<li><p>获取到仓库地址，克隆到本地</p>
</li>
<li><p>进行开发修改代码，添加、提交。</p>
</li>
<li><p>下班之前要推送到远程仓库</p>
<p>3.1 先确定所有的都提交了（commit）</p>
<p>3.2 推送之前先拉取</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure>

<p>3.3 正式推送</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>以后每一天：</strong></p>
<ol>
<li><p>早上上班，拉取远程仓库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure>
</li>
<li><p>进行开发修改代码，添加、提交。</p>
</li>
<li><p>下班之前要推送到远程仓库</p>
<p>3.1 先确定所有的都提交了（commit）</p>
<p>3.2 推送之前先拉取</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure>

<p>3.3 正式推送</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="③-冲突解决"><a href="#③-冲突解决" class="headerlink" title="③ 冲突解决"></a>③ 冲突解决</h4><p>与合并分支类似，多个成员如果修改了同一个文件，就会出现冲突； 本地拉取文件的时候，如果远程仓库中与本地的提交有冲突，解决：修改再次提交， 再推送</p>
<h3 id="7-4-GitHub-免密登录"><a href="#7-4-GitHub-免密登录" class="headerlink" title="7.4 GitHub 免密登录"></a>7.4 GitHub 免密登录</h3><ol>
<li><p>创建非对称加密对</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;xxx@xxx.com&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>文件默认存储在家目录（c:&#x2F;用户&#x2F;用户名&#x2F;.ssh）的 .ssh 文件夹中。</p>
<ul>
<li>id_rsa 私钥</li>
<li>id_rsa.pub 公钥</li>
</ul>
</li>
<li><p>将公钥（.pub）文件内容配置到账号的秘钥中</p>
<p>首页 -&gt; 右上角头像-&gt; settings -&gt; SSH and GPG keys -&gt; new SSH Key</p>
</li>
<li><p>克隆代码时，选择 ssh 模式进行克隆 （地址 在仓库首页 绿色 克隆的位置 选择 use ssh）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com/unclealan/team-repo-1.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>克隆代码时的提醒，这里需要输入 <code>yes</code></p>
</li>
</ol>
<h2 id="8-GitFlow-Git-开发流程"><a href="#8-GitFlow-Git-开发流程" class="headerlink" title="8 GitFlow - Git 开发流程"></a>8 GitFlow - Git 开发流程</h2><p><img src="D:\1-尚硅谷课件\SH220310\第三阶段\day13_Git\images\GitFlow.png" alt="GitFlow"></p>
<ul>
<li>Master 主分支。上面只保存正式发布的版本</li>
<li>Hotfix 线上代码 Bug 修复分支。开发完后需要合并回Master和Develop分支。</li>
<li>Feather 功能分支。当开发某个功能时，创建一个单独的分支，开发完毕后再合并到 dev 分支</li>
<li>Release 分支。待发布分支，Release分支基于Develop分支创建，在这个Release分支上测试，修改Bug</li>
<li>Develop 开发分支。开发者都在这个分支上提交代码</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/04/Git/" data-id="cl4007ohr0000q4dxbc2tahhz" data-title="Git" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">git</a></li></ul>

    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/" rel="tag">Node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Node/" style="font-size: 10px;">Node</a> <a href="/tags/git/" style="font-size: 10px;">git</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/06/04/Node/">Node</a>
          </li>
        
          <li>
            <a href="/2022/06/04/Git/">Git</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 yxl<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>